<div class="wrapper">
  <input
    type="hidden"
    class="sheet-tabstoggle"
    name="attr_sheet_tab"
    title="@{sheet_tab}"
    value="personal" />
  <div class="navigation-bar">
    <button type="action" name="act_personal">Personal</button>
    <button type="action" name="act_skills">Skills</button>
    <button type="action" name="act_combat">Combat &amp; Wounds</button>
    <button type="action" name="act_magic">Magic</button>
    <button type="action" name="act_assets">Assets</button>
  </div>

  <section class="tab" id="section-personal">
    <div class="section-box" id="portrait">
      <h3>Portrait</h3>
      <img
        class="portrait"
        src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/fc40415351ad246c0d3e67292d1fc11116e1a51e/Rivers%20of%20London/images/police-in-action.svg"
        alt="Police officer in action from https://freesvg.org/policeman-in-act" />
    </div>

    <div class="section-box" id="investigator-info">
      <h3>Investigator Info</h3>
      <div>
        <div class="input-row col-2">
          <label>Name</label><input type="text" name="attr_character_name" />
        </div>
        <div class="input-row col-2">
          <label for="attr_occupation">Occupation</label>
          <input
            type="text"
            name="attr_occupation"
            list="occupations"
            placeholder="Choose an Occupation" />
        </div>
        <div class="input-row col-2">
          <label>Place of Birth</label>
          <input type="text" name="attr_place_of_birth" />
        </div>
        <div class="input-row col-2">
          <label>Residence</label><input type="text" name="attr_residence" />
          <label>Pronoun</label><input type="text" name="attr_pronoun" />
        </div>
        <div class="input-row col-2">
          <label>Age</label><input type="number" name="attr_age" />
          <label>Affluence</label><input type="text" name="attr_affluence" />
        </div>
        <div class="input-row col-1">
          <textarea
            name="attr_inv_notes"
            placeholder="Additional notes"></textarea>
        </div>
      </div>
    </div>
    <div class="section-box" id="backstory">
      <h3>Backstory</h3>
      <div>
        <textarea
          name="attr_backstory"
          placeholder="What I did before last summer…"></textarea>
      </div>
    </div>
    <div class="section-box" id="casefiles">
      <h3>Case Files</h3>
      <div>
        <textarea
          name="attr_casefiles"
          placeholder="Whom I arrested last summer…"></textarea>
      </div>
    </div>
  </section>

  <section class="tab" id="section-skills">
    <div class="section-box" id="characteristics">
      <h3>Characteristics</h3>
      <div>
        <button
          type="roll"
          name="roll_str"
          value="&{template:default} {{name=Strength (@{str})}}  {{Roll=[[1d100]]}}"></button>
        <label for="attr_str">
          <span> <span class="stat-abbreviation">STR</span>ength </span>
        </label>
        <input type="number" name="attr_str" title="@{str}" min="0" max="100" />
        /
        <input
          type="number"
          name="attr_str_half"
          value="round(@{str}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_con"
          value="/em uses Constitution (@{con}) and rolls [[d100]]"></button>
        <label for="attr_con"
          ><span class="stat-abbreviation">CON</span>stitution</label
        >
        <input type="number" name="attr_con" title="@{con}" min="0" max="100" />
        /
        <input
          type="number"
          name="attr_con_half"
          value="round(@{con}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_dex"
          value="/em uses Dexterity (@{dex}) and rolls [[d100]]"></button>
        <label for="attr_dex"
          ><span class="stat-abbreviation">DEX</span>terity</label
        >
        <input type="number" name="attr_dex" title="@{dex}" min="0" max="100" />
        /
        <input
          type="number"
          name="attr_dex_half"
          value="round(@{dex}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_int"
          value="/em uses Intelligence (@{int}) and rolls [[d100]]"></button>
        <label for="attr_int"
          ><span class="stat-abbreviation">INT</span>elligence</label
        >
        <input type="number" name="attr_int" title="@{int}" min="0" max="100" />
        /
        <input
          type="number"
          name="attr_int_half"
          value="round(@{int}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_pow"
          value="/em uses Power (@{pow}) and rolls [[d100]]"></button>
        <label><span class="stat-abbreviation">POW</span>er</label>
        <input type="number" name="attr_pow" title="@{pow}" min="0" max="100" />
        /
        <input
          type="number"
          name="attr_pow_half"
          value="round(@{pow}/2)"
          disabled />
      </div>
    </div>

    <div class="section-box" id="supplemental-info">
      <h3>Supplemental Info</h3>
      <div>
        <label for="attr_mov"><span class="stat-abbreviation">MOV</span></label>
        <input type="text" name="attr_mov" title="@{mov}" />
      </div>
      <div>
        <label for="attr_current_luck">Luck</label>
        <input
          type="number"
          name="attr_starting_luck"
          title="@{starting_luck}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_current_luck"
          title="@{current_luck}"
          min="0"
          max="100" />
      </div>
      <div>
        <label for="attr_current_magic">Magic Pts</label>
        <input
          type="number"
          name="attr_starting_magic"
          title="@{starting_magic}"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_current_magic"
          title="@{current_magic}"
          min="0"
          max="100" />
      </div>
    </div>

    <div id="advantages-and-disadvantages" class="section-box">
      <h3>Advantages &amp; Disadvantages</h3>
      <fieldset class="repeating_vantages">
        <div class="vantage">
          <select name="attr_vantagetype">
            <option>Advantage</option>
            <option>Disadvantage</option>
          </select>
          <input type="text" name="attr_vantagename" />
        </div>
      </fieldset>
    </div>

    <div id="common-skills" class="section-box">
      <h3>Common Skills</h3>
      <div>
        <button
          type="roll"
          name="roll_athletics"
          value="/em uses Athletics (@{athletics}) and rolls [[d100]]"></button>
        <label for="attr_athletics">Athletics</label>
        <input
          type="number"
          name="attr_athletics"
          title="@{athletics}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_athletics_half"
          value="round(@{athletics}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_drive"
          value="/em uses Drive (@{drive}) and rolls [[d100]]"></button>
        <label for="attr_drive">Drive</label>
        <input
          type="number"
          name="attr_drive"
          title="@{drive}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_drive_half"
          value="round(@{drive}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_navigate"
          value="/em uses Navigate (@{navigate}) and rolls [[d100]]"></button>
        <label for="attr_navigate">Navigate</label>
        <input
          type="number"
          name="attr_navigate"
          title="@{navigate}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_navigate_half"
          value="round(@{navigate}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_observation"
          value="/em uses Observation (@{observation}) and rolls [[d100]]"></button>
        <label for="attr_observation">Observation</label>
        <input
          type="number"
          name="attr_observation"
          title="@{observation}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_observation_half"
          value="round(@{observation}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_read_person"
          value="/em uses Read Person (@{read_person}) and rolls [[d100]]"></button>
        <label for="attr_read_person">Read Person</label>
        <input
          type="number"
          name="attr_read_person"
          title="@{read_person}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_read_person_half"
          value="round(@{read_person}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_research"
          value="/em uses Research (@{research}) and rolls [[d100]]"></button>
        <label for="attr_research">Research</label>
        <input
          type="number"
          name="attr_research"
          title="@{research}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_research_half"
          value="round(@{research}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_sense_vestigia"
          value="/em uses Sense Vestigia (@{sense_vestigia}) and rolls [[d100]]"></button>
        <label for="attr_sense_vestigia">Sense Vestigia</label>
        <input
          type="number"
          name="attr_sense_vestigia"
          title="@{sense_vestigia}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_sense_vestigia_half"
          value="round(@{sense_vestigia}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_social"
          value="/em uses Social (@{social}) and rolls [[d100]]"></button>
        <label for="attr_social">Social</label>
        <input
          type="number"
          name="attr_social"
          title="@{social}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_social_half"
          value="round(@{social}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_stealth"
          value="/em uses Stealth (@{stealth}) and rolls [[d100]]"></button>
        <label for="attr_stealth">Stealth</label>
        <input
          type="number"
          name="attr_stealth"
          title="@{stealth}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_stealth_half"
          value="round(@{stealth}/2)"
          disabled />
      </div>
    </div>

    <div id="expert-skills" class="section-box">
      <h3>Expert Skills</h3>

      <fieldset class="repeating_expertskills">
        <button
          type="roll"
          name="roll_expertskill"
          value="/em uses @{expertskillname} (@{expertskill}) and rolls [[d100]]"></button>
        <label for="attr_expertskill">
          <input type="text" name="attr_expertskillname" />
        </label>
        <input
          type="number"
          name="attr_expertskill"
          title="@{expertskill}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_expertskill_half"
          value="round(@{expertskill}/2)"
          disabled />
      </fieldset>
    </div>
  </section>

  <section class="tab" id="section-combat">
    <div id="combat" class="section-box">
      <h3>Combat</h3>
      <div>
        <button
          type="roll"
          name="roll_fighting"
          value="/em uses Fighting (@{fighting}) and rolls [[d100]]"></button>
        <label for="attr_fighting">Fighting</label>
        <input
          type="number"
          name="attr_fighting"
          title="@{fighting}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_fighting_half"
          value="round(@{Fighting}/2)"
          disabled />
      </div>
      <div>
        <button
          type="roll"
          name="roll_firearms"
          value="/em uses Firearms (@{firearms}) and rolls [[d100]]"></button>
        <label for="attr_firearms">Firearms</label>
        <input
          type="number"
          name="attr_firearms"
          title="@{firearms}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_firearms_half"
          value="round(@{firearms}/2)"
          disabled />
      </div>
    </div>

    <div id="weapons" class="section-box">
      <h3>Weapons</h3>
      <fieldset class="repeating_weapons">
        <button
          type="roll"
          name="roll_weapon"
          value="/em uses @{weaponname} (@{weapon}) and rolls [[d100]]"></button>
        <label for="attr_weapon">
          <input type="text" name="attr_weaponname" />
        </label>
        <input
          type="number"
          name="attr_weapon"
          title="@{weapon}"
          value="0"
          min="0"
          max="100" />
        /
        <input
          type="number"
          name="attr_weapon_half"
          value="round(@{weapon}/2)"
          disabled />
        /
        <input type="text" name="attr_weapon_dmg" />
        /
        <input type="text" name="attr_weapon_range" />
      </fieldset>
    </div>
    <div id="damage" class="section-box">
      <h3>Damage</h3>
      <div>
        <input
          class="damage-checkbox"
          type="checkbox"
          id="attr_hurt"
          name="attr_hurt"
          value="1" /><label for="attr_hurt">Hurt</label>
      </div>
      <div>
        <input
          class="damage-checkbox"
          type="checkbox"
          id="attr_bloodied"
          name="attr_bloodied"
          value="1" /><label for="attr_bloodied">Bloodied</label>
      </div>
      <div>
        <input
          class="damage-checkbox"
          type="checkbox"
          id="attr_down"
          name="attr_down"
          value="1" /><label for="attr_down">Down</label>
      </div>
      <div>
        <input
          class="damage-checkbox"
          type="checkbox"
          id="attr_impaired"
          name="attr_impaired"
          value="1" /><label for="attr_impaired">Impaired</label>
      </div>
    </div>
  </section>

  <section class="tab" id="section-magic">
    <div id="spells" class="section-box">
      <h3>Magic Spells</h3>
      <fieldset class="repeating_spells">
        <div>
          <input
            class="magic-checkbox"
            type="checkbox"
            id="attr_cast"
            name="attr_cast"
            value="1" />
        </div>
        <input type="text" name="attr_spellorder" value="Order" />
        /
        <input type="text" name="attr_spellname" value="Name"/>
      </fieldset>
    </div>

    <div id="signare" class="section-box">
      <h3>Signare</h3>
      <fieldset class="repeating_signare">
        <input type="text" name="attr_signare" />
      </fieldset>
    </div>
  </section>

  <section class="tab" id="section-assets">
    <div id="equipment" class="section-box">
      <h3>Equipment</h3>
      <fieldset class="repeating_equipment">
        <input type="text" name="attr_equipment" />
      </fieldset>
    </div>
  </section>

  <script type="text/worker">
    /* ---------------------------------------------------------------------------------------------------
     * Tabs button worker
     * --------------------------------------------------------------------------------------------------- */
    const buttonlist = ["personal", "skills", "combat", "magic", "assets"];
    buttonlist.forEach(button => {
      on(`clicked:${button}`, function() {
          setAttrs({
              sheet_tab: button
            });
        });
    });
  </script>
</div>

<div class="background_image">

    <div class="info_and_firstStats">
        <div class="info">
            <input class="name" type="text" name="attr_characterName">
            <input class="personality" type="text" name="attr_pgPast">
            <input class="origin" type="text" name="attr_pgOrigin">
            <input class="rank" type="text" name="attr_pgRank">
        </div>
        <div class="info">
            <input class="past" type="text" name="attr_pgPast">
            <input class="vice" type="text" name="attr_pgSin">
            <input class="special" type="text" name="attr_pgSpecialTrait">
            <input class="bonus_capacity" type="text" name="attr_BonusCapacity">
        </div>
    </div>

    <div>

        <div class="first_attributes">
            <div>
                <input class="first_attributes_input_sx" type="text" name="attr_pgvigor_sx">
                <input class="first_attributes_input_dx" type="text" name="attr_pgvigor_dx">
            </div>
            <div class="first_attributes_align">
                <input class="first_attributes_input_sx" type="text" name="attr_pgdexterity_sx">
                <input class="first_attributes_input_dx" type="text" name="attr_pgdexterity_dx">
            </div>
            <div class="first_attributes_align">
                <input class="first_attributes_input_sx" type="text" name="attr_pgmind_sx">
                <input class="first_attributes_input_dx" type="text" name="attr_pgmind_dx">
            </div>
            <div class="first_attributes_align">
                <input class="first_attributes_input_sx" type="text" name="attr_pgmagnetism_sx">
                <input class="first_attributes_input_dx" type="text" name="attr_pgmagnetism_dx">
            </div>
        </div>

        <div class="all_bonus">
            <div class="bonus_input_1">
                <input class="bonus_input_other_sx" type="text" name="attr_pgbonus_1" readonly>
                <input class="bonus_input_other_dx" type="text" name="attr_pgbonus_2">
            </div>
            <div class="bonus_input_2">
                <input class="bonus_input_other_sx" type="text" name="attr_pgbonus_3" readonly>
                <input class="bonus_input_other_dx" type="text" name="attr_pgbonus_4">
            </div>
            <div class="bonus_input_2">
                <input class="bonus_input_other_sx" type="text" name="attr_bonus_5" readonly>
                <input class="bonus_input_other_dx" type="text" name="attr_pgbonus_6">
            </div>
            <div class="bonus_input_2">
                <input class="bonus_input_other_sx" type="text" name="attr_pgbonus_7" readonly>
                <input class="bonus_input_other_dx" type="text" name="attr_pgbonus_8">
            </div>
        </div>

        <div class="second_attributes">
            <div>
                <input class="second_attributes_input_sx" type="text" name="attr_pgathletics_sx">
                <button type="roll" class="second_attributes_buttons" value="&{template:default} {{name=@{characterName}, Atletismo}} {{Atletismo=[[1d12skh1+@{pgathletics_dx}]]}}"></button>
                <input class="second_attributes_input_dx" type="text" name="attr_pgathletics_dx">
            </div>
            <div class="first_attributes_align">
                <input class="second_attributes_input_sx" type="text" name="attr_pgagility_sx">
                <button type="roll" class="second_attributes_buttons" value="&{template:default} {{name=@{characterName}, Agilità}} {{Agilità=[[1d12skh1+@{pgagility_dx}]]}}"></button>
                <input class="second_attributes_input_dx" type="text" name="attr_pgagility_dx">
            </div>
            <div class="first_attributes_align">
                <input class="second_attributes_input_sx" type="text" name="attr_pganalysis_sx">
                <button type="roll" class="second_attributes_buttons" value="&{template:default} {{name=@{characterName}, Analisi}} {{Analisi=[[1d12skh1+@{pganalysis_dx}]]}}"></button>
                <input class="second_attributes_input_dx" type="text" name="attr_pganalysis_dx">
            </div>
            <div class="first_attributes_align">
                <input class="second_attributes_input_sx" type="text" name="attr_pgaggression_sx">
                <button type="roll" class="second_attributes_buttons" value="&{template:default} {{name=@{characterName}, Aggressività}} {{Aggressività=[[1d12skh1+@{pgaggression_dx}]]}}"></button>
                <input class="second_attributes_input_dx" type="text" name="attr_pgaggression_dx">
            </div>
        </div>

        <div class="other_attributes">
            <div>
                <input class="other_attributes_input_sx" type="text" name="attr_pgfight_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Lotta}} {{Lotta=[[1d12skh1+@{pgfight_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgfight_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgstealth_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Furtività}} {{Furtività=[[1d12skh1+@{pgstealth_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgstealth_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgintuition_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Intuito}} {{Intuito=[[1d12skh1+@{pgintuition_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgintuition_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgcunning_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Astuzia}} {{Astuzia=[[1d12skh1+@{pgcunning_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgcunning_dx">
            </div>
        </div>

        <div class="other_attributes">
            <div>
                <input class="other_attributes_input_sx" type="text" name="attr_pgpower_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Potenza}} {{Potenza=[[1d12skh1+@{pgpower_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgpower_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgmanual_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Manualità}} {{Manualità=[[1d12skh1+@{pgmanual_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgmanual_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgsenses_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Sensi}} {{Sensi=[[1d12skh1+@{pgsenses_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgsenses_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgcharm_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Carisma}} {{Carisma=[[1d12skh1+@{pgcharm_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgcharm_dx">
            </div>
        </div>

        <div class="other_attributes_end">
            <div>
                <input class="other_attributes_input_sx" type="text" name="attr_pgresistence_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Resistenza}} {{Resistenza=[[1d12skh1+@{pgresistence_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgresistence_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgreactivity_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Reattività}} {{Reattività=[[1d12skh1+@{pgreactivity_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgreactivity_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgdiscipline_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Disciplina}} {{Disciplina=[[1d12skh1+@{pgdiscipline_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgdiscipline_dx">
            </div>
            <div class="first_attributes_align">
                <input class="other_attributes_input_sx" type="text" name="attr_pgluck_sx">
                <button type="roll" class="other_attributes_buttons" value="&{template:default} {{name=@{characterName}, Fortuna}} {{Fortuna=[[1d12skh1+@{pgluck_dx}]]}}"></button>
                <input class="other_attributes_input_dx" type="text" name="attr_pgluck_dx">
            </div>
        </div>

    </div>

    <div class="combat_1">

        <div class="align_stuff">
            <button type="roll" class="init_button"
                value="&{template:default} {{name=@{characterName}, Iniziativa}} {{Iniziativa=[[1d12skh1+@{pgdiscipline_dx}]]}}"></button>
            <input class="init_input" name="attr_pginitiative">
        </div>

        <div class="align_stuff">
            <input class="healt_input" name="attr_pghealt">
        </div>

        <div class="align_stuff">
            <button type="roll" class="melee_button"
                value="&{template:default} {{name=@{characterName}, @{pgmelee}}} {{@{pgmelee}=[[1d12skh1+@{pgmelee_2}]]}}"></button>
            <input class="melee_input" name="attr_pgmelee">
            <input class="melee_input_2" name="attr_pgmelee_2">
        </div>

        <div class="align_stuff_damage">
            <button type="roll" class="number_button_first" name="button_weapon_1">1</button>
            <button type="roll" class="number_button" name="button_weapon_2">2</button>
            <button type="roll" class="number_button" name="button_weapon_3">3</button>
            <button type="roll" class="number_button" name="button_weapon_4">4</button>
            <button type="roll" class="number_button" name="button_weapon_5">5</button>
            <button type="roll" class="number_button" name="button_weapon_6">6</button>
            <button type="roll" class="number_button" name="button_weapon_7">7</button>
            <button type="roll" class="number_button" name="button_weapon_8">8</button>
            <button type="roll" class="number_button" name="button_weapon_9">9</button>
            <button type="roll" class="number_button_double" name="button_weapon_10">10</button>
            <button type="roll" class="number_button_double" name="button_weapon_11">11</button>
            <button type="roll" class="number_button_double_2" name="button_weapon_12">12</button>
        </div>

        <div class="align_stuff">
            <button type="roll" class="dodge_button"
                value="&{template:default} {{name=@{characterName}, Schivare}} {{Schivare=[[1d12skh1+@{pgreactivity_dx}]]}}"></button>
            <input class="dodge_input" name="attr_pgdodge_3">
        </div>

    </div>

    <div class="combat_2">

        <div class="align_stuff">
            <button type="roll" class="init_button" name="attr_pgdodge_4_button"
                value="&{template:default} {{name=@{characterName}, Schivare}} {{Schivare=[[1d12skh1+@{pgreactivity_dx}]]}}"></button>
            <input class="init_input" name="attr_pgdodge_4">
        </div>

        <div class="align_stuff">
            <input class="healt_input" name="attr_pgmovement">
        </div>

        <div class="align_stuff">
            <button type="roll" class="melee_button"
                value="&{template:default} {{name=@{characterName}, @{pgranged}}} {{@{pgranged}=[[1d12skh1+@{pgranged_2}]]}}"></button>
            <input class="melee_input" name="attr_pgranged">
            <input class="melee_input_2" name="attr_pgranged_2">
        </div>

        <div class="align_stuff_damage">
            <button type="roll" class="number_button_first" name="button_first_weapon_1">1</button>
            <button type="roll" class="number_button" name="button_first_weapon_2">2</button>
            <button type="roll" class="number_button" name="button_first_weapon_3">3</button>
            <button type="roll" class="number_button" name="button_first_weapon_4">4</button>
            <button type="roll" class="number_button" name="button_first_weapon_5">5</button>
            <button type="roll" class="number_button" name="button_first_weapon_6">6</button>
            <button type="roll" class="number_button" name="button_first_weapon_7">7</button>
            <button type="roll" class="number_button" name="button_first_weapon_8">8</button>
            <button type="roll" class="number_button" name="button_first_weapon_9">9</button>
            <button type="roll" class="number_button_double" name="button_first_weapon_10">10</button>
            <button type="roll" class="number_button_double" name="button_first_weapon_11">11</button>
            <button type="roll" class="number_button_double_2" name="button_first_weapon_12">12</button>
        </div>

        <div class="align_stuff">
            <button type="roll" class="dodge_button"
                value="&{template:default} {{name=@{characterName}, Schivare}} {{Schivare=[[1d12skh1+@{pgreactivity_dx}]]}}"></button>
            <input class="dodge_input" name="attr_pgdodge_2">
        </div>

    </div>

    <div class="combat_3">

        <div class="align_stuff">
            <button type="roll" class="init_button"
                value="&{template:default} {{name=@{characterName}, Eludere}} {{Eludere=[[1d12skh1+@{pgluck_dx}]]}}"></button>
            <input class="init_input" name="attr_pgevade">
        </div>

        <div class="align_stuff">
            <input class="healt_input" name="attr_pgdamage_reduction">
        </div>

        <div class="align_stuff">
            <input class="melee_input_some" name="attr_pgsome_weapon">
            <input class="melee_input_some_2" name="attr_pgsome_weapon_2">
        </div>

        <div class="align_stuff_damage">
            <button type="roll" class="number_button_first" name="button_second_weapon_1">1</button>
            <button type="roll" class="number_button" name="button_second_weapon_2">2</button>
            <button type="roll" class="number_button" name="button_second_weapon_3">3</button>
            <button type="roll" class="number_button" name="button_second_weapon_4">4</button>
            <button type="roll" class="number_button" name="button_second_weapon_5">5</button>
            <button type="roll" class="number_button" name="button_second_weapon_6">6</button>
            <button type="roll" class="number_button" name="button_second_weapon_7">7</button>
            <button type="roll" class="number_button" name="button_second_weapon_8">8</button>
            <button type="roll" class="number_button" name="button_second_weapon_9">9</button>
            <button type="roll" class="number_button_double" name="button_second_weapon_10">10</button>
            <button type="roll" class="number_button_double" name="button_second_weapon_11">11</button>
            <button type="roll" class="number_button_double_2" name="button_second_weapon_12">12</button>
        </div>

        <div class="align_stuff">
            <button type="roll" class="dodge_button"
                value="&{template:default} {{name=@{characterName}, Schivare}} {{Schivare=[[1d12skh1+@{pgreactivity_dx}]]}}"></button>
            <input class="dodge_input" name="attr_pgdodge">
        </div>

    </div>

    <div class="annotations">

        <div class="eqip">
            <input class="input_equip" type="text" name="attr_pgequip_1">
            <input class="input_equip" type="text" name="attr_pgequip_2">
            <input class="input_equip" type="text" name="attr_pgequip_3">
            <input class="input_equip" type="text" name="attr_pgequip_4">
            <input class="input_equip" type="text" name="attr_pgequip_5">
            <input class="input_equip" type="text" name="attr_pgequip_6">
            <input class="input_equip" type="text" name="attr_pgequip_7">
            <input class="input_equip" type="text" name="attr_pgequip_8">
            <input class="input_equip" type="text" name="attr_pgequip_9">
            <input class="input_equip" type="text" name="attr_pgequip_10">
        </div>
        <div class="money_1">
            <div class="money_input">
                <input class="money" type="text" name="attr_pgmoney_1">
                <input class="money" type="text" name="attr_pgmoney_2">
                <input class="money" type="text" name="attr_pgmoney_3">
                <input class="money" type="text" name="attr_pgmoney_4">
                <input class="money" type="text" name="attr_pgmoney_5">
                <input class="money" type="text" name="attr_pgmoney_6">
                <input class="money" type="text" name="attr_pgmoney_7">
                <input class="money" type="text" name="attr_pgmoney_8">
                <input class="money" type="text" name="attr_pgmoney_9">
                <input class="money" type="text" name="attr_pgmoney_10">
            </div>
            <div class="money_input_2">
                <input class="money_cash" type="text" name="attr_pgcash">
                <input class="money_cash_2" type="text" name="attr_pg_total_cash">
            </div>
        </div>
        <div class="art_and_opport">
            <input class="art_and_opport_input" type="text" name="attr_pgao_1">
            <input class="art_and_opport_input" type="text" name="attr_pgao_2">
            <input class="art_and_opport_input" type="text" name="attr_pgao_3">
            <input class="art_and_opport_input" type="text" name="attr_pgao_4">
            <input class="art_and_opport_input" type="text" name="attr_pgao_5">
            <input class="art_and_opport_input" type="text" name="attr_pgao_6">
            <input class="art_and_opport_input" type="text" name="attr_pgao_7">
            <input class="art_and_opport_input" type="text" name="attr_pgao_8">
            <input class="art_and_opport_input" type="text" name="attr_pgao_9">
            <input class="art_and_opport_input" type="text" name="attr_pgao_10">
        </div>
        <div class="other_money">
            <input class="other_money_input" type="text" name="attr_pgother_money_1">
            <input class="other_money_input" type="text" name="attr_pgother_money_2">
            <input class="other_money_input" type="text" name="attr_pgother_money_3">
            <input class="other_money_input" type="text" name="attr_pgother_money_4">
            <input class="other_money_input" type="text" name="attr_pgother_money_5">
            <input class="other_money_input" type="text" name="attr_pgother_money_6">
            <input class="other_money_input" type="text" name="attr_pgother_money_7">
            <input class="other_money_input" type="text" name="attr_pgother_money_8">
            <input class="other_money_input" type="text" name="attr_pgother_money_9">
            <input class="other_money_input" type="text" name="attr_pgother_money_10">
            <div class="other_money_2">
                <input class="other_money_input_2" type="text" name="attr_pgattributes">
                <input class="other_money_input_3" type="text" name="attr_pgattributes_tot">
            </div>
        </div>
        <div class="traits">
            <div class="knowledge">
                <input class="knowledge_input" type="text" name="attr_pgknowledge_1">
                <input class="knowledge_input" type="text" name="attr_pgknowledge_2">
                <input class="knowledge_input" type="text" name="attr_pgknowledge_3">
                <input class="knowledge_input" type="text" name="attr_pgknowledge_4">
                <input class="knowledge_input" type="text" name="attr_pgknowledge_5">
                <input class="knowledge_input" type="text" name="attr_pgknowledge_6">
                <input class="knowledge_input" type="text" name="attr_pgknowledge_7">
            </div>
            <div class="skills">
                <input class="skills_input" type="text" name="attr_pgskills_1">
                <input class="skills_input" type="text" name="attr_pgskills_2">
                <input class="skills_input" type="text" name="attr_pgskills_3">
                <input class="skills_input" type="text" name="attr_pgskills_4">
            </div>

        </div>

    </div>

</div>


<script type="text/worker">

    // color change
    const colors = ["transparent", "green", "yellow", "red"];
    function changeColor(button_first_weapon_2) {
        var current = Number(button.dataset.ci || 0); // init to 0 on first click
        current = (current + 1) % colors.length; // clamp array index
        button.dataset.ci = current; // store new value in element
        button.style.backgroundColor = colors[current]; // set color
    }

    // bonus n°1
    on("change:pgathletics_sx change:pgfight_sx change:pgpower_sx change:pgresistence_sx sheet:opened", function() {  
        getAttrs(["pgathletics_sx", "pgfight_sx", "pgpower_sx", "pgresistence_sx"], function(values) {
            let a = values.pgathletics_sx
            let b = values.pgfight_sx
            let c = values.pgpower_sx
            let d = values.pgresistence_sx
            let e = a+b+c+d
            setAttrs({                            
                pgvigor_sx = e
            });
        });
    });
    if ( @{pgvigor_sx} >= 18) {
        @{pgbonus_1} = "+3";
    }
    else if ( @{pgvigor_sx} >= 10 &&  @{pgvigor_sx} <= 17) {
        @{pgbonus_1} = "+2";
    }
    else if ( @{pgvigor_sx} >= 3 &&  @{pgvigor_sx} <= 9) {
        @{pgbonus_1} = "+1";
    }
    else if ( @{pgvigor_sx} < 2) {
        @{pgbonus_1} = "0";
    }

    // bonus n°2
    on("change:pgagility_sx change:pgstealth_sx change:pgmanual_sx change:pgreactivity_sx sheet:opened", function() {  
        getAttrs(["pgagility_sx", "pgstealth_sx", "pgmanual_sx", "pgreactivity_sx"], function(values) {
            let f = values.pgagility_sx
            let g = values.pgstealth_sx
            let h = values.pgmanual_sx
            let i = values.pgreactivity_sx
            let j = f+g+h+i
            setAttrs({                            
                pgdexterity_sx.value = j
            });
        });
    });
    if ( @{pgdexterity_sx} >= 18) {
        @{pgbonus_3} = "+3";
    }
    else if ( @{pgdexterity_sx} >= 10 &&  @{pgdexterity_sx} <= 17) {
        @{pgbonus_3} = "+2";
    }
    else if ( @{pgdexterity_sx} >= 3 &&  @{pgdexterity_sx} <= 9) {
        @{pgbonus_3} = "+1";
    }
    else if ( @{pgdexterity_sx} < 2) {
        @{pgbonus_3} = "0";
    }

    // bonus n°3
    on("change:pganalysis_sx change:pgintuition_sx change:pgsenses_sx change:pgdiscipline_sx sheet:opened", function() {  
        getAttrs(["pganalysis_sx", "pgintuition_sx", "pgsenses_sx", "pgdiscipline_sx"], function(values) {
            let k = values.pganalysis_sx
            let l = values.pgintuition_sx
            let m = values.pgsenses_sx
            let n = values.pgdiscipline_sx
            let o = k+l+m++n
            setAttrs({                            
                pgmind_sx = o
            });
        });
    });
    if ( @{pgmind_sx} >= 18) {
        @{bonus_5} = "+3";
    }
    else if ( @{pgmind_sx} >= 10 && @{pgmind_sx} <= 17) {
        @{bonus_5} = "+2";
    }
    else if (document.getElementById("pgmind_sx").value >= 3 && document.getElementById("pgmind_sx").value <= 9) {
        @{bonus_5} = "+1";
    }
    else if (document.getElementById("pgmind_sx").value < 2) {
        @{bonus_5} = "0";
    }

    // bonus n°4
    on("change:pgaggression_sx change:pgcunning_sx change:pgcharm_sx change:pgluck_sx sheet:opened", function() {  
        getAttrs(["pgaggression_sx", "pgcunning_sx", "pgcharm_sx", "pgluck_sx"], function(values) {
            let p = values.pgaggression_sx
            let q = values.pgcunning_sx
            let r = values.pgcharm_sx
            let s = values.pgluck_sx
            let t = p+q+r+s
            setAttrs({                            
                pgmagnetism_sx = t
            });
        });
    });
    if ( @{pgmagnetism_sx} >= 18) {
        @{pgbonus_7} = "+3";
    }
    else if ( @{pgmagnetism_sx} >= 10 &&  @{pgmagnetism_sx} <= 17) {
        document.getElementById("pgbonus_7").value = "+2";
    }
    else if ( @{pgmagnetism_sx} >= 3 &&  @{pgmagnetism_sx} <= 9) {
        @{pgbonus_7} = "+1";
    }
    else if ( @{pgmagnetism_sx} < 2) {
        @{pgbonus_7} = "0";
    }

    // money and totals
    on("change:pgmoney_1 change:pgmoney_2 change:pgmoney_3 change:pgmoney_4 change:pgmoney_5 change:pgmoney_6 change:pgmoney_7 change:pgmoney_8 change:pgmoney_9 change:pgmoney_10 sheet:opened", function() {  
        getAttrs(["pgmoney_1","pgmoney_2","pgmoney_3","pgmoney_4","pgmoney_5","pgmoney_6","pgmoney_7","pgmoney_8","pgmoney_9","pgmoney_10"], function(value) {
            let totCash = values.pgmoney_1 + values.pgmoney_2 + values.pgmoney_3 + values.pgmoney_4 + values.pgmoney_5 + values.pgmoney_6 + values.pgmoney_7 + values.pgmoney_8 + values.pgmoney_9 + values.pgmoney_10
            setAttrs({
                pg_total_cash = totCash
            })
        })
    });
    on("change:pgother_money_1 change:pgother_money_2 change:pgother_money_3 change:pgother_money_4 change:pgother_money_5 change:pgother_money_6 change:pgother_money_7 change:pgother_money_8 change:pgother_money_9 change:pgother_money_10 sheet:opened", function() {  
        getAttrs(["pgother_money_1","pgother_money_2","pgother_money_3","pgother_money_4","pgother_money_5","pgother_money_6","pgother_money_7","pgother_money_8","pgother_money_9","pgother_money_10"], function(value) {
            let totCash2 = values.pgother_money_1 + values.pgother_money_2 + values.pgother_money_3 + values.pgother_money_4 + values.pgother_money_5 + values.pgother_money_6 + values.pgother_money_7 + values.pgother_money_8 + values.pgother_money_9 + values.pgother_money_10
            setAttrs({
                pgattributes = totCash2
            })
        })
    });
    on("change:pg_total_cash change:pgattributes sheet:opened", function() {  
        getAttrs(["pg_total_cash","pgattributes"], function(value) {
            let totPg = values.pg_total_cash + values.pgattributes
            setAttrs({
                pgattributes_tot = totPg
            })
        })
    });

    on("change:pgathletics_sx change:pgfight_sx change:pgpower_sx change:pgresistence_sx change: pgvigor_dx sheet:opened", function() {  
        getAttrs(["pgathletics_sx", "pgfight_sx", "pgpower_sx", "pgresistence_sx", "pgvigor_dx"], function(values) {
            let at = values.pgathletics_sx
            let fi = values.pgfight_sx
            let po = values.pgpower_sx
            let re = values.pgresistence_sx
            let vig = values.pgvigor_dx
            setAttrs({                            
                pgathletics_dx = vig + at
                pgfight_dx = vig + fi
                pgpower_dx =  vig + po
                pgresistence_dx =  vig + re
            });
        });
    });

    on("change:pgagility_sx change:pgstealth_sx change:pgmanual_sx change:pgreactivity_sx change:pgdexterity_dx sheet:opened", function() {  
        getAttrs(["pgagility_sx", "pgstealth_sx", "pgmanual_sx", "pgreactivity_sx", "pgdexterity_dx" ], function(values) {
            let ag = values.pgagility_sx
            let st = values.pgstealth_sx
            let man = values.pgmanual_sx
            let reg = values.pgreactivity_sx
            let dex = values.pgdexterity_dx
            setAttrs({                            
                pgagility_dx = dex + ag
                pgstealth_dx = dex + st
                pgmanual_dx = dex + man
                pgreactivity_dx = dex + reg
            });
        });
    });

    on("change:pganalysis_sx change:pgintuition_sx change:pgsenses_sx change:pgdiscipline_sx change:pgmind_dx sheet:opened", function() {  
        getAttrs(["pganalysis_sx", "pgintuition_sx", "pgsenses_sx", "pgdiscipline_sx", "pgmind_dx"], function(values) {
            let an = values.pganalysis_sx
            let in = values.pgintuition_sx
            let se = values.pgsenses_sx
            let di = values.pgdiscipline_sx
            let mi = values.npgmind_dx
            setAttrs({                            
                pganalysis_dx = mi + an
                pgintuition_dx = mi + in
                pgsenses_dx = mi + se
                pgdiscipline_dx = mi + di
            });
        });
    });

    on("change:pgaggression_sx change:pgcunning_sx change:pgcharm_sx change:pgluck_sx change:pgmagnetism_dx sheet:opened", function() {  
        getAttrs(["pgaggression_sx", "pgcunning_sx", "pgcharm_sx", "pgluck_sx", "pgmagnetism_dx"], function(values) {
            let agg = values.pgaggression_sx
            let cun = values.pgcunning_sx
            let char = values.pgcharm_sx
            let lu = values.pgluck_sx
            let mag = values.pgmagnetism_dx
            setAttrs({                            
                pgaggression_dx = mag + agg
                pgcunning_dx = mag + cun
                pgcharm_dx = mag + char
                pgluck_dx = mag + lu
            });
        });
    });

</script>
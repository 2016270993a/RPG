<script type="text/worker">

function rollDie(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function updateAbility(name) {
    var baseName = name + "Base";
    var lootName = name + "LootBonus";
    
    getAttrs([baseName, lootName], function (values) {
        var calculated = parseInt(values[baseName]) + parseInt(values[lootName]);
        
        var obj = {};
        obj[name] = calculated;
        setAttrs(obj);
    });
}

on("change:RollDeathSaveCheck", function () {
    setAttrs({ DeathSaveCounter: rollDie(1, 6) });
});

on("change:StrengthBase", function() { updateAbility("Strength"); });
on("change:StrengthLootBonus", function() { updateAbility("Strength"); });
on("change:DexterityBase", function() { updateAbility("Dexterity"); });
on("change:DexterityLootBonus", function() { updateAbility("Dexterity"); });
on("change:ConstitutionBase", function() { updateAbility("Constitution"); });
on("change:ConstitutionLootBonus", function() { updateAbility("Constitution"); });
on("change:IntelligenceBase", function() { updateAbility("Intelligence"); });
on("change:IntelligenceLootBonus", function() { updateAbility("Intelligence"); });
on("change:WisdomBase", function() { updateAbility("Wisdom"); });
on("change:WisdomLootBonus", function() { updateAbility("Wisdom"); });
on("change:CharismaBase", function() { updateAbility("Charisma"); });
on("change:CharismaLootBonus", function() { updateAbility("Charisma"); });

on("change:ArmorBase", function() { updateAbility("Armor"); });
on("change:ArmorLootBonus", function() { updateAbility("Armor"); });

on("change:BasicEffortBase", function() { updateAbility("BasicEffort"); });
on("change:BasicEffortLootBonus", function() { updateAbility("BasicEffort"); });
on("change:WeaponsEffortBase", function() { updateAbility("WeaponsEffort"); });
on("change:WeaponsEffortLootBonus", function() { updateAbility("WeaponsEffort"); });
on("change:MagicEffortBase", function() { updateAbility("MagicEffort"); });
on("change:MagicEffortLootBonus", function() { updateAbility("MagicEffort"); });
on("change:UltimateEffortBase", function() { updateAbility("UltimateEffort"); });
on("change:UltimateEffortLootBonus", function() { updateAbility("UltimateEffort"); });

</script>

<div class="body">
	<!-- Set up the Tabs -->
	<input type="radio" class="sheet-tab sheet-tab1" name="attr_core-tab" value="1" title="Mecha" checked="checked"/> 
	<span class="sheet-tab sheet-tab1" style='line-height: 20px;'>Mecha</span>
	<input type="radio" class="sheet-tab sheet-tab2" name="attr_core-tab" value="2" title="Kaiju"/> 
	<span class="sheet-tab sheet-tab2" style='line-height: 20px;'>Kaiju</span>
	
    <div class="sheet-section-sheet1"><!-- Sheet1 Tab -->
		<div>
		    <input type="text" class="sheet-text" name="attr_name" style='margin-top: 25px; margin-left: 175px; width: 270px'/>
		</div>
	</div>
</div>
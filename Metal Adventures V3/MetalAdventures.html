<!--  HEADER -->

<div class="charsheet">
	<div class="banner">
	</div>

	<div class="menu">
		<label>
			<input type="radio" name="attr_tab" value="pj">
			<span title="PJ"/>
		</label>
		<label>
			<input type="radio" name="attr_tab" value="pnj">
			<span title="PNJ"/>
		</label>
		<label>
			<input type="radio" name="attr_tab" value="ship">
			<span title="Vaisseau"/>
		</label>
		<label>
			<input type="radio" name="attr_tab" value="param">
			<span title="y"/>
		</label>
	</div>
	<input type="hidden" name="attr_tab" class="tabExtend" value="pj" />

	<!--Options de jet-->
	<div class="row">
		<div class="flex-grow1">
			<div class="flex-grow2 column-header">
				<span>Options de jet</span>
			</div>
		</div>
	</div>
	<div class="row">
	   <div class="flex-grow2">
			<label>
				<span data-i18n="whisper-rolls">Jet masqué ?</span>
				<select name="attr_wtype">
					<option value="" selected="true" data-i18n="never">Never</option>
					<option value="/w gm " data-i18n="always">Always</option>
					<option value="?{Whisper|Public Roll,|Whisper Roll,/w gm } " data-i18n="querry">Querry</option>
				</select>
			</label>
		</div>
		<div class="flex-grow2">
		   <label>
			   <span data-i18n="metal-facktor">MF ?</span>
			   <select name="attr_roll_mf">
				   <option value="" selected="true">Sans</option>
				   <option value="{{MF=[[?{Metal Faktor}d6>@{roll_success_diff}]]}}">Avec</option>
				   <!-- <option value="">Uniquement</option> -->
			   </select>
		   </label>
	   </div>
	   <div class="flex-grow2">
		  <label>
			  <span>Bonus ?</span>
			  <select name="attr_roll_bonus">
				  <option value="0" selected="true">Sans</option>
				  <option value="?{Dés bonus / malus|0}">Avec</option>
			  </select>
		  </label>
	  </div>
		<div class="flex-grow2">
			<label>
				<span data-i18n="rolls-success-diff">Difficulté ?</span>
				<select name="attr_roll_success_diff">
					<option value="4" selected="true" data-i18n="normal">Normal</option>
					<option value="6" data-i18n="td">TD</option>
					<option value="2" data-i18n="tf">TF</option>
				</select>
			</label>
		</div>
	</div>
	<input type="hidden" name="attr_MAd6Roll" value="@{wtype} &{template:MA} {{color=brown}} {{subtitle=@{character_name}}} @{roll_mf} {{buttons=[PMF](~GPMF)[SC](~GSC)[E2F](~GE2F)[pmf](~ppmf)[sc](~psc)[e2f](~pe2f)}} {{color=brown}}" />
	<input type="hidden" name="attr_MAd6RollMod" value="@{wtype} &{template:MA} {{color=brown}} {{subtitle=@{character_name}}} {{color=brown}}" />

	<!-- <input type="hidden" name="attr_MAd6Roll" value="@{wtype} &{template:MA} {{color=brown}} {{subtitle=@{character_name}}} @{roll_mf} {{buttons=[PMF](~PMF)}} {{color=brown}}" /> -->
	<input type="hidden" name="attr_roll_result" value="0" />

	<div class="charsheet switch-tab-content tab-pj">
		<!-- PJ<input type="radio" name="switch-tab2" class="switch-tab2-pj" value="PJ" checked="checked"> -->
		<!-- PNJ<input type="radio" name="switch-tab2" class="switch-tab2-pnj" value="PNJ"> -->

  		<!--Tab PJ-->
		<div class="charsheet switch-tab-content tab2-pj">
            <div class="row">
			    <!--Identité-->
				<div class="flex-grow1">
					<div class="row">
						<div class="flex-grow2 column-header">Identité</div>
					</div>

                    <!--Nom-->
					<div class="row">
						<div class="flex-grow1"><label>Nom</label></div>
						<div class="flex-grow1 flex-right">
							<input type="text" name="attr_character_name">
						</div>
					</div>

					<!--Archétype-->
					<div class="row">
						<div class="flex-grow1"><label>Archétype</label></div>
						<div class="flex-grow1 flex-right">
							<select name="attr_archetype" class="auto">
								<option valeur="Ingénieur">Ingénieur</option>
								<option valeur="Canonnier">Canonnier</option>
								<option valeur="El Seductor">El Seductor</option>
								<option valeur="Fusilier de l'espace">Fusilier de l'espace</option>
								<option valeur="Historien">Historien</option>
								<option valeur="Navigateur">Navigateur</option>
							</select>
						</div>
					</div>

					<!--Origine-->
					<div class="row">
						<div class="flex-grow1"><label>Origine</label></div>
						<div class="flex-grow1 flex-right">
							<input type="text" name="attr_origine">
						</div>
					</div>

					<!--Sexe-->
					<div class="row">
						<div class="flex-grow1"><label>Sexe</label></div>
						<div class="flex-grow1 flex-right">
							<input type="text" name="attr_sexe">
						</div>
					</div>

					<!-- Overdrive -->
					<div class="row">
						<div class="flex-grow1"><label>Overdrive</label></div>
						<div class="flex-grow1 flex-right">
							<input type="text" name="attr_overdrive">
						</div>
					</div>

					<!--Mutant-->
					<div class="row">
						<div class="flex-grow1">
							<label>Mutant</label>
						</div>
						<div class="flex-shrink flex-left radio">
							<input type="radio" name="attr_mutant" value="1">Oui
							<input type="radio" name="attr_mutant" value="0" checked="true">Non
						</div>
					</div>
				</div>

				<!-- Santé -->
				<!-- <input type="hidden" class="santeEtat" name="attr_SanteEtat" value="indemne"> -->
				<div class="flex-grow1">
					<div class="row">
						<div class="flex-grow2 column-header">Santé</div>
					</div>

					<!-- Protection -->
					<div class="row">
						<div class="flex-grow1">
							<label>Protection</label>
						</div>
						<div class="flex-grow1  flex-right">
							<input type="number" name="attr_prot" title="Protection">
							<input type="text" name="attr_protLoc" title="Localisation">
						</div>
					</div>

					<div class="row">
						<div class="flex-grow2 health">
							<!-- <input class="health" type="text" name="attr_SanteEtat" readonly> -->
						</div>
						<div class="flex-grow1 flex-right">
							<input class="number-title" value="Sup." readonly>
							<input class="number-title" value="Réel" readonly>
							<input class="number-title" value="Max" readonly>
						</div>
					</div>
					<div class="row">
						<div class="flex-grow1"><label>Indemne</label></div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_Indemne_sup">
							<input type="number" name="attr_Indemne">
							<input type="number" name="attr_Indemne_max" readonly>
						</div>
					</div>
					<div class="row">
						<div class="flex-grow1"><label>Blessé léger</label></div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_BlesseLeger_sup" value="0">
							<input type="number" name="attr_BlesseLeger" value="0">
							<input type="number" name="attr_BlesseLeger_max" readonly>
						</div>
					</div>
					<div class="row">
						<div class="flex-grow1"><label>Blessé grave</label></div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_BlesseGrave_sup" value="0">
							<input type="number" name="attr_BlesseGrave" value="0">
							<input type="number" name="attr_BlesseGrave_max" readonly>
						</div>
					</div>
					<div class="row">
						<div class="flex-grow1"><label>Mort ?</label></div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_Mort_sup" value="0">
							<input type="number" name="attr_Mort" value="0">
							<input type="number" name="attr_Mort_max" readonly>
						</div>
					</div>
				</div>

                <!--Autres-->
				<div class="flex-grow1">
					<div class="row">
						<div class="flex-grow2 column-header">Autres</div>
					</div>

					<!--Expérience-->
					<div class="row">
						<div class="flex-grow1"><label>Expérience</label></div>
						<div class="flex-grow1 flex-right">
							<input class="great100" type="number" name="attr_Experience" title="Restant" value="0">
							<input class="great100" type="number" name="attr_Experience_max" title="Total">
							<input class="great100" type="number" name="attr_Experience_precedente" hidden>
						</div>
					</div>
					<div class="row">
						<div class="flex-grow2"></div>
						<div class="flex-grow1 flex-right">
							<input class="number-title" value="Réel" readonly>
							<input class="number-title" value="Max" readonly>
						</div>
					</div>

					<!--Panache-->
					<div class="row">
						<div class="flex-grow1"><label>Panache</label></div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_Panache">
							<input type="number" name="attr_Panache_max" value="3">
						</div>
					</div>

					<!--Energie X-->
					<div class="row">
						<div class="flex-grow1"><label>Énergie X</label></div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_EnergieX">
							<input type="number" name="attr_EnergieX_max">
						</div>
					</div>

					<!--Gloire-->
					<div class="row">
						<div class="flex-grow1"><label>Gloire</label></div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_Gloire" value="0">
							<input type="number" name="attr_GloireBonus" title="Bonus" readonly>
						</div>
					</div>
				</div>

				<!-- Aptitude spéciale -->
				<!-- TODO -->
			</div>
        </div>

        <!--Tab PNJ-->
		<div class="charsheet switch-tab-content tab2-pnj">
			<div class="row">
				<div class="flex-grow-1">
					<div class="row">
						<div class="flex-grow2 column-header">PNJ</div>
					</div>

					<!-- Archetype -->
					<!-- <div class="row"> -->
						<!-- <div class="columnFlex"> -->
							<!-- <label>Archetype</label> -->
						<!-- </div> -->
						<!-- <div class="flex-grow1"> -->
							<!-- <input type="text" name="attr_pnjArchetype" placeholder="Archetype" title="Archetype du pnj"> -->
						<!-- </div> -->
					<!-- </div> -->

					<!-- Role -->
					<!-- <div class="row"> -->
						<!-- <div class="columnFlex"><label>Role</label></div> -->
						<!-- <div class="flex-grow1"> -->
							<!-- <select name="attr_pnjRole"> -->
								<!-- <option value="Figurant">Figurant</option> -->
								<!-- <option value="SecondRole">Second Rôle</option> -->
								<!-- <option value="PremierRole">Premier Rôle</option> -->
							<!-- </select> -->
						<!-- </div> -->
					<!-- </div> -->

					<!-- Niveau -->
					<div class="row">
						<div class="columnFlex"><label>Niveau</label></div>
						<div class="flex-grow1">
							<select name="attr_pnjNiveau">
								<option value="Normal">Normal</option>
								<option value="Élite">Élite</option>
								<option value="Boss">Boss</option>
								<option value="Big Boss">Big Boss</option>
								<option value="Héros">Héros</option>
							</select>
						</div>
					</div>

					<!-- <input type="hidden" name="attr_pnjRole" class="tabExtendPnjRole" value="Figurant"/> -->
					<!-- <div class="pnj-role-content pnj-role"> -->
			            <!--Origines-->
						<div class="row">
							<div class="columnFlex"><label>Origines</label></div>
							<div class="flex-grow1">
								<input type="text" name="attr_pnjOrigines">
							</div>
						</div>

			            <!--Port d'attache-->
						<div class="row">
							<div class="columnFlex">
								<label>Port d'attache</label>
							</div>
							<div class="flex-grow1">
								<input type="text" name="attr_pnjPortdAttache">
							</div>
						</div>

						<!-- Gloire -->
						<div class="row">
							<div class="columnFlex">
								<label>Gloire</label>
							</div>
							<div class="flex-grow1">
								<input type="number" name="attr_pnjGloire" title="Gloire">
								<input type="text" name="attr_pnjGloireDescription" title="Détail">
							</div>
						</div>

						<!-- Panache -->
						<div class="row">
							<div class="flex-grow1 flex-right">
								<input class="number-title" value="Réel" readonly>
								<input class="number-title" value="Max" readonly>
							</div>
						</div>
						<div class="row">
							<div class="columnFlex">
								<label>Point de panache</label>
							</div>
							<div class="flex-grow1 flex-right">
								<input type="number" name="attr_pnjPP" title="Point de panache">
								<input type="number" name="attr_pnjPP_max" title="Point de panache maximum">
							</div>
						</div>
					</div>
				<!-- </div> -->

				<!-- Identité et ressources -->
				<div class="flex-grow1">
					<div class="row">
						<div class="flex-grow2 column-header">Identité et Ressources</div>
					</div>

					<fieldset class="repeating_pnjSante">
						<div class="border-top">
							<div class="row">
								<div class="columnFlex">
									<label>Nom</label>
								</div>
								<div class="flex-grow1">
									<input type="text" name="attr_pnjName" placeholder="Name" title="Nom du pnj">
								</div>
							</div>

							<div class="row">
								<label>Energie X</label>
								<input type="number" name="attr_pnjEX" title="Energie X">
								<input type="number" name="attr_pnjEX_max" title="Energie X maximum">
							</div>


							<div class="row">
								<div class="flex-grow1"></div>
								<div class="flex-grow1 flex-right">
									<input class="number-title" value="Sup" readonly>
									<input class="number-title" value="Réel" readonly>
									<input class="number-title" value="Max" readonly>
								</div>
							</div>

							<div class="row">
								<div class="flex-grow1"><label>Indemne</label></div>
								<div class="flex-grow1 flex-right">
									<input type="number" name="attr_pnjIndemne_sup">
									<input type="number" name="attr_pnjIndemne">
									<input type="number" name="attr_pnjIndemne_max" readonly>
								</div>
							</div>
							<div class="row">
								<div class="flex-grow1"><label>Blessé léger</label></div>
								<div class="flex-grow1 flex-right">
									<input type="number" name="attr_pnjBlesseLeger_sup" value="0">
									<input type="number" name="attr_pnjBlesseLeger" value="0">
									<input type="number" name="attr_pnjBlesseLeger_max" readonly>
								</div>
							</div>
							<div class="row">
								<div class="flex-grow1"><label>Blessé grave</label></div>
								<div class="flex-grow1 flex-right">
									<input type="number" name="attr_pnjBlesseGrave_sup" value="0">
									<input type="number" name="attr_pnjBlesseGrave" value="0">
									<input type="number" name="attr_pnjBlesseGrave_max" readonly>
								</div>
							</div>
							<div class="row">
								<div class="flex-grow1"><label>Mort ?</label></div>
								<div class="flex-grow1 flex-right">
									<input type="number" name="attr_pnjMort_sup" value="0">
									<input type="number" name="attr_pnjMort" value="0">
									<input type="number" name="attr_pnjMort_max" readonly>
								</div>
							</div>
						</div>
					</fieldset>
				</div>

			</div>
		</div>

        <!--Caractéristiques-->
		<div class="row">
			<!-- Agilité -->
			<div class="carac-block">
				<div class="column-header">Agilité</div>
				<div class="row">
					<div class="flex-grow1">
						<span><input type="checkbox" name="attr_predilection_Technique" value="0">Techniques</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Technique" value="0">
					</div>
				</div>
				<div class="row column-subheader">
					<div class="flex-grow1">
						<!-- <span>Compétences</span> -->
					</div>
					<div class="flex-grow1 flex-right">
						<input class="number-subtitle" value="Base." readonly>
						<input class="number-subtitle" value="Tot." readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<!-- <label> -->
						<!-- <input type="checkbox" name="attr_Acrobatie_PMF" value="[test](~Ebis Lap|PMF)" /> -->
						<button type="roll" class="text-roll-button" name="roll_Acrobatie" value="@{MAd6Roll} {{title=Acrobatie}} {{Succès=[[(@{Acrobatie|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
						<!-- <button type="roll" class="text-roll-button" value="&{template:ma} {{name=test}}"> -->
            				Acrobatie
            			</button>
						<!-- <label> -->
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Acrobatie">
						<input type="number" name="attr_Acrobatie_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
			            <button type="roll" class="mf text-roll-button" name="roll_ArmesDePoing" value="@{MAd6Roll} {{title=Armes De Poing}} {{Succès=[[(@{ArmesDePoing|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
			            	Armes de poing
			            </button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_ArmesDePoing">
						<input type="number" name="attr_ArmesDePoing_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_ArmesDeEpaule" value="@{MAd6Roll} {{title=Armes d'épaule}} {{Succès=[[(@{ArmesDeEpaule|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
			            	Armes d'épaule
			            </button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_ArmesDEpaule">
						<input type="number" name="attr_ArmesDEpaule_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_ArmesEmbarquee" value="@{MAd6Roll} {{title=Armes embarquée}} {{Succès=[[(@{ArmesEmbarquee|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
			            	[Armes embarquée]
			            </button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_ArmesEmbarquee">
						<input type="number" name="attr_ArmesEmbarquee_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Artisanat" value="@{MAd6Roll} {{title=Artisanat (@{ArtisanatLabel})}} {{Succès=[[(@{Artisanat|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
			            	Artisanat (<input type="text" name="attr_ArtisanatLabel">)
			            </button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Artisanat">
						<input type="number" name="attr_Artisanat_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_Pilotage1" value="@{MAd6Roll} {{title=Pilotage (@{Pilotage1Label})}} {{Succès=[[(@{Pilotage1|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
			            	[Pilotage (<input type="text" name="attr_Pilotage1Label">)
			            </button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Pilotage1">
						<input type="number" name="attr_Pilotage1_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_Pilotage2" value="@{MAd6Roll} {{title=Pilotage (@{Pilotage2Label})}} {{Succès=[[(@{Pilotage2|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
			            	[Pilotage
			            </button>
						<span class="mf">
							(<input type="text" name="attr_Pilotage2Label">)]
						</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Pilotage2">
						<input type="number" name="attr_Pilotage2_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Technologie" value="@{MAd6Roll} {{title=Technologie}} {{Succès=[[(@{Technologie|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Technologie
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Technologie">
						<input type="number" name="attr_Technologie_max" readonly>
					</div>
				</div>

				<fieldset class="repeating_AgiliteSkills">
					<div class="row">
						<div class="flex-grow1">
							<button type="roll" class="text-weapon-roll-button" name="roll_repeating_Agilite" value="@{MAd6Roll} {{title=@{SkillName}}} {{Succès=[[(@{SkillBase|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							</button>
							<input type="text" name="attr_SkillName"/>
						</div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_SkillBase">
							<input type="number" name="attr_SkillBase_max" readonly>
						</div>
					</div>
				</fieldset>
			</div>
			<!-- Carrure -->
			<div class="carac-block">
				<div class="column-header">Carrure</div>

				<div class="row">
					<div class="flex-grow1">
						<span><input type="checkbox" name="attr_predilection_survie" value="0">Survie</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Survie" value="0">
					</div>
				</div>
				<div class="row column-subheader">
					<div class="flex-grow1">
						<!-- <span>Compétences</span> -->
					</div>
					<div class="flex-grow1 flex-right">
						<input class="number-subtitle" value="Base." readonly>
						<input class="number-subtitle" value="Tot." readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_ArmesDeJet" value="@{MAd6Roll} {{title=Armes de jet}} {{Succès=[[(@{ArmesDeJet|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Armes de jet
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_ArmesdeJet">
						<input type="number" name="attr_ArmesdeJet_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_ArmesLourdes" value="@{MAd6Roll} {{title=Armes lourdes}} {{Succès=[[(@{ArmesLourdes|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Armes lourdes]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_ArmesLourdes">
						<input type="number" name="attr_ArmesLourdes_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Athletisme" value="@{MAd6Roll} {{title=Athlétisme}} {{Succès=[[(@{Athletisme|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Athlétisme
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Athletisme">
						<input type="number" name="attr_Athletisme_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Equitation" value="@{MAd6Roll} {{title=Équitation}} {{Succès=[[(@{Equitation|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Équitation
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Equitation">
						<input type="number" name="attr_Equitation_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_Melee" value="@{MAd6Roll} {{title=Mêlée}} {{Succès=[[(@{Melee|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Mêlée
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Melee">
						<input type="number" name="attr_Melee_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Environnement1" value="@{MAd6Roll} {{title=Environnement (@{Environement1Label})}} {{Succès=[[(@{Environnement1|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Environnement
						</button>
						<span>(<input type="text" name="attr_Environement1Label">)</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Environement1">
						<input type="number" name="attr_Environement1_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Environnement2" value="@{MAd6Roll} {{title=Environnement (@{Environement2Label})}} {{Succès=[[(@{Environnement2|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Environnement
						</button>
						<span>(<input type="text" name="attr_Environement2Label">)</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Environement2">
						<input type="number" name="attr_Environement2_max" readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Environnement3" value="@{MAd6Roll} {{title=Environnement (@{Environement3Label})}} {{Succès=[[(@{Environnement3|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Environnement
						</button>
						<span>(<input type="text" name="attr_Environement3Label">)</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Environement3">
						<input type="number" name="attr_Environement3_max" readonly>
					</div>
				</div>

				<fieldset class="repeating_CarrureSkills">
					<div class="row">
						<div class="flex-grow1">
							<button type="roll" class="text-weapon-roll-button" name="roll_repeating_carrure" value="@{MAd6Roll} {{title=@{SkillName}}} {{Succès=[[(@{SkillBase|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							</button>
							<input type="text" name="attr_SkillName"/>
						</div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_SkillBase">
							<input type="number" name="attr_SkillBase_max" readonly>
						</div>
					</div>
				</fieldset>
			</div>
			<!-- Perception -->
			<div class="carac-block">
				<div class="column-header">Perception</div>
				<div class="row">
					<div class="flex-grow1">
						<span><input type="checkbox" name="attr_predilection_espionnage" value="0">Espionnage</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Espionnage" value="0">
					</div>
				</div>
				<div class="row column-subheader">
					<div class="flex-grow1">
						<!-- <span>Compétences</span> -->
					</div>
					<div class="flex-grow1 flex-right">
						<input class="number-subtitle" value="Base." readonly>
						<input class="number-subtitle" value="Tot." readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Deguisement" value="@{MAd6Roll} {{title=Deguisement}} {{Succès=[[(@{Deguisement|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Déguisement
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Deguisement">
						<input type="number" name="attr_Deguisement_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Discretion" value="@{MAd6Roll} {{title=Discrétion}} {{Succès=[[(@{Discretion|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Discrétion
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Discretion">
						<input type="number" name="attr_Discretion_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Empathie" value="@{MAd6Roll} {{title=Empathie}} {{Succès=[[(@{Empathie|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Empathie
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Empathie">
						<input type="number" name="attr_Empathie_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Falsification" value="@{MAd6Roll} {{title=Falsification}} {{Succès=[[(@{Falsification|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Falsification]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Falsification">
						<input type="number" name="attr_Falsification_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Recherche" value="@{MAd6Roll} {{title=Recherche}} {{Succès=[[(@{Recherche|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Recherche
						</button>
					</div>
					<div>
						<input type="number" name="attr_Recherche">
						<input type="number" name="attr_Recherche_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Senseurs" value="@{MAd6Roll} {{title=Senseurs}} {{Succès=[[(@{Senseurs|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Senseurs]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Senseurs">
						<input type="number" name="attr_Senseurs_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_SysSecu" value="@{MAd6Roll} {{title=Sys. Sécu}} {{Succès=[[(@{SysSecu|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Sys. Sécu]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_SysSecu">
						<input type="number" name="attr_SysSecu_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Vigilance" value="@{MAd6Roll} {{title=Vigilance}} {{Succès=[[(@{Vigilance|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Vigilance
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Vigilance">
						<input type="number" name="attr_Vigilance_max" readonly>
					</div>
				</div>

				<fieldset class="repeating_PerceptionSkills">
					<div class="row">
						<div class="flex-grow1">
							<button type="roll" class="text-weapon-roll-button" name="roll_repeating_perception" value="@{MAd6Roll} {{title=@{SkillName}}} {{Succès=[[(@{SkillBase|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							</button>
							<input type="text" name="attr_SkillName"/>
						</div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_SkillBase">
							<input type="number" name="attr_SkillBase_max" readonly>
						</div>
					</div>
				</fieldset>
			</div>
		</div>
		<div class="row">
			<!-- Intelligence -->
			<div class="carac-block">
				<div class="column-header">Intelligence</div>

				<div class="row">
					<div class="flex-grow1">
						<span><input type="checkbox" name="attr_predilection_Science" value="0">Science</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Science" value="0">
					</div>
				</div>
				<div class="row column-subheader">
					<div class="flex-grow1">
						<!-- <span>Compétences</span> -->
					</div>
					<div class="flex-grow1 flex-right">
						<input class="number-subtitle" value="Base." readonly>
						<input class="number-subtitle" value="Tot." readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Analyse" value="@{MAd6Roll} {{title=Analyse}} {{Succès=[[(@{Analyse|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Analyse
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Analyse">
						<input type="number" name="attr_Analyse_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Arts" value="@{MAd6Roll} {{title=Arts (@{ArtsLabel})}} {{Succès=[[(@{Arts|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Arts
						</button>
						<span> (<input type="text" name="attr_ArtsLabel">)</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Art">
						<input type="number" name="attr_Art_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Connaissance1" value="@{MAd6Roll} {{title=Connaissance (@{Connaissance1Label})}} {{Succès=[[(@{Connaissance1|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Connaissance
						</button>
						<span> (<input type="text" name="attr_Connaissance1Label">)</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Connaissance1">
						<input type="number" name="attr_Connaissance1_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Connaissance2" value="@{MAd6Roll} {{title=Connaissance (@{Connaissance2Label})}} {{Succès=[[(@{Connaissance2|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Connaissance
						</button>
						<span> (<input type="text" name="attr_Connaissance2Label">)</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Connaissance2">
						<input type="number" name="attr_Connaissance2_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Connaissance3" value="@{MAd6Roll} {{title=Connaissance (@{Connaissance3Label})}} {{Succès=[[(@{Connaissance3|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Connaissance
						</button>
						<span> (<input type="text" name="attr_Connaissance3Label">)</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Connaissance3">
						<input type="number" name="attr_Connaissance3_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Esoterisme" value="@{MAd6Roll} {{title=Ésotérisme}} {{Succès=[[(@{Esoterisme|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Ésotérisme]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Esoterisme">
						<input type="number" name="attr_Esoterisme_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Histoire" value="@{MAd6Roll} {{title=Histoire}} {{Succès=[[(@{Histoire|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Histoire
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Histoire">
						<input type="number" name="attr_Histoire_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Ingenierie" value="@{MAd6Roll} {{title=Ingénierie}} {{Succès=[[(@{Ingenierie|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Ingénierie]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Ingenierie">
						<input type="number" name="attr_Ingenierie_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Medecine" value="@{MAd6Roll} {{title=Médecine}} {{Succès=[[(@{Medecine|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Médecine]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Medecine">
						<input type="number" name="attr_Medecine_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Navigation" value="@{MAd6Roll} {{title=Navigation}} {{Succès=[[(@{Navigation|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Navigation
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Navigation">
						<input type="number" name="attr_Navigation_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_SciencesSolaires" value="@{MAd6Roll} {{title=Sciences Solaires}} {{Succès=[[(@{SciencesSolaires|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Sciences Solaires]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_SciencesSolaires">
						<input type="number" name="attr_SciencesSolaires_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_SciencesStellaires" value="@{MAd6Roll} {{title=Sciences Stellaires}} {{Succès=[[(@{SciencesStellaires|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Sciences Stellaires]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_SciencesStellaires">
						<input type="number" name="attr_SciencesStellaires_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Strategie" value="@{MAd6Roll} {{title=Stratégie}} {{Succès=[[(@{Strategie|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Stratégie
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Strategie">
						<input type="number" name="attr_Strategie_max" readonly>
					</div>
				</div>

				<fieldset class="repeating_ScienceSkills">
					<div class="row">
						<div class="flex-grow1">
							<button type="roll" class="text-weapon-roll-button" name="roll_repeating_science" value="@{MAd6Roll} {{title=@{SkillName}}} {{Succès=[[(@{SkillBase|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							</button>
							<input type="text" name="attr_SkillName"/>
						</div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_SkillBase">
							<input type="number" name="attr_SkillBase_max" readonly>
						</div>
					</div>
				</fieldset>
			</div>

            <!--Présence-->
			<div class="carac-block">
				<div class="column-header">Présence</div>

				<div class="row">
					<div class="flex-grow1">
						<span><input type="checkbox" name="attr_predilection_Negociation" value="0">Négociation</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Negociation" value="0">
					</div>
				</div>
				<div class="row column-subheader">
					<div class="flex-grow1">
						<!-- <span>Compétences</span> -->
					</div>
					<div class="flex-grow1 flex-right">
						<input class="number-subtitle" value="Base." readonly>
						<input class="number-subtitle" value="Tot." readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Baratin" value="@{MAd6Roll} {{title=Baratin}} {{Succès=[[(@{Baratin|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Baratin
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Baration">
						<input type="number" name="attr_Baration_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Bureaucratie" value="@{MAd6Roll} {{title=Bureaucratie}} {{Succès=[[(@{Bureaucratie|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Bureaucratie
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Bureaucratie">
						<input type="number" name="attr_Bureaucratie_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Comedie" value="@{MAd6Roll} {{title=Comédie}} {{Succès=[[(@{Comedie|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Comédie
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Comedie">
						<input type="number" name="attr_Comedie_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Commerce" value="@{MAd6Roll} {{title=Commerce}} {{Succès=[[(@{Commerce|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Commerce
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Commerce">
						<input type="number" name="attr_Commerce_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Danse" value="@{MAd6Roll} {{title=Danse}} {{Succès=[[(@{Danse|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Danse
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Danse">
						<input type="number" name="attr_Danse_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Eloquence" value="@{MAd6Roll} {{title=Éloquence}} {{Succès=[[(@{Eloquence|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Éloquence
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Eloquence">
						<input type="number" name="attr_Eloquence_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Etiquette" value="@{MAd6Roll} {{title=Étiquette}} {{Succès=[[(@{Etiquette|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Étiquette
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Etiquette">
						<input type="number" name="attr_Etiquette_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Jeux" value="@{MAd6Roll} {{title=Jeux}} {{Succès=[[(@{Jeux|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Jeux
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Jeux">
						<input type="number" name="attr_Jeux_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_Seduction" value="@{MAd6Roll} {{title=Séduction}} {{Succès=[[(@{Seduction|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Séduction
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Seduction">
						<input type="number" name="attr_Seduction_max" readonly>
					</div>
				</div>

				<fieldset class="repeating_PresenceSkills">
					<div class="row">
						<div class="flex-grow1">
							<button type="roll" class="text-weapon-roll-button" name="roll_repeating_presence" value="@{MAd6Roll} {{title=@{SkillName}}} {{Succès=[[(@{SkillBase|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							</button>
							<input type="text" name="attr_SkillName"/>
						</div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_SkillBase">
							<input type="number" name="attr_SkillBase_max" readonly>
						</div>
					</div>
				</fieldset>
			</div>

            <!--Sang-froid-->
			<div class="carac-block">
				<div class="column-header">Sang-froid</div>

				<div class="row">
					<div class="flex-grow1">
						<span><input type="checkbox" name="attr_predilection_Trempe" value="0">Trempe</span>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Trempe" value="0">
					</div>
				</div>
				<div class="row column-subheader">
					<div class="flex-grow1">
						<!-- <span>Compétences</span> -->
					</div>
					<div class="flex-grow1 flex-right">
						<input class="number-subtitle" value="Base." readonly>
						<input class="number-subtitle" value="Tot." readonly>
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Commandement" value="@{MAd6Roll} {{title=Commandement}} {{Succès=[[(@{Commandement|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Commandement
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Commandement">
						<input type="number" name="attr_Commandement_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_Demolition" value="@{MAd6Roll} {{title=Démolition}} {{Succès=[[(@{Demolition|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							[Démolition]
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Demolition">
						<input type="number" name="attr_Demolition_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_Determination" value="@{MAd6Roll} {{title=Détermination}} {{Succès=[[(@{Determination|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Détermination
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Determination">
						<input type="number" name="attr_Determination_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Dressage" value="@{MAd6Roll} {{title=Dressage}} {{Succès=[[(@{Dressage|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Dressage
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Dressage">
						<input type="number" name="attr_Dressage_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Illegalités" value="@{MAd6Roll} {{title=Illégalités}} {{Succès=[[@{Illegalités|max}d6>@{roll_success_diff}]]}}">
							Illégalités
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Illegalites">
						<input type="number" name="attr_Illegalites_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="mf text-roll-button" name="roll_Intimidation" value="@{MAd6Roll} {{title=Intimidation}} {{Succès=[[(@{Intimidation|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Intimidation
						</button>
					</div>
					<div class="flex-grow1 flex-right g">
						<input type="number" name="attr_Intimidation">
						<input type="number" name="attr_Intimidation_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Premierssoins" value="@{MAd6Roll} {{title=Premiers soins}} {{Succès=[[(@{Premierssoins|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Premiers soins
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Premierssoins">
						<input type="number" name="attr_Premierssoins_max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1">
						<button type="roll" class="text-roll-button" name="roll_Tactique" value="@{MAd6Roll} {{title=Tactique}} {{Succès=[[(@{Tactique|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							Tactique
						</button>
					</div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_Tactique">
						<input type="number" name="attr_Tactique_max" readonly>
					</div>
				</div>

				<fieldset class="repeating_SangfroidSkills">
					<div class="row">
						<div class="flex-grow1">
							<button type="roll" class="text-weapon-roll-button" name="roll_repeating_sangfroid" value="@{MAd6Roll} {{title=@{SkillName}}} {{Succès=[[(@{SkillBase|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
							</button>
							<input type="text" name="attr_SkillName"/>
						</div>
						<div class="flex-grow1 flex-right">
							<input type="number" name="attr_SkillBase">
							<input type="number" name="attr_SkillBase_max" readonly>
						</div>
					</div>
				</fieldset>
			</div>
		</div>

		<!-- Armes -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Armes</div>

				<!-- Main nues -->
				<button class="mf weapon-roll-button" type="roll" value=" @{MAd6Roll} {{title=Mains Nues}} {{desc=@{ArmesMainNues|max}}} {{Compétence=Melée}} {{Dégats=@{ArmesMainNues}}} {{Succès=[[(@{Melee|max}+@{roll_bonus})d6>@{roll_success_diff}]]}}">
				</button>
				<!-- <input type="text" value="Melée" title="Compétence de l'arme" readonly> -->
				<select name="attr_ArmesSkill" title="Compétence de l'arme" class="auto" disabled="true">
					<option value="Melee">Mêlée</option>
					<option value="ArmesdeJet">Armes de jet</option>
					<option value="ArmesLourdes">Armes lourdes</option>
					<option value="ArmesDePoing">Armes de poing</option>
					<option value="ArmesDEpaule">Armes d'épaule</option>
					<option value="ArmesEmbarquee">Armes embarquées</option>
				</select>
				<input type="text" value="Main nues" readonly>
				<input type="text" name="attr_ArmesMainNues" readonly>
				<input type="text" name="attr_ArmesMainNues_max" placeholder="Avec Bonus" title="Avec Bonus">

				<!-- Autres armes -->
				<fieldset class="repeating_Armes">
					<input type="hidden" name="attr_ArmesRollTemplate" value="@{MAd6Roll} {{title=@{ArmesNom}}} {{desc=@{ArmesDesc}}} {{Compétence=@{ArmesSkill}}} {{Dégats=@{ArmesDegat}}} {{Mode=@{ModeDeTir}}} {{Portée=@{ArmesPortee}m}}" />
					<input type="hidden" name="attr_ArmesRoll" value="{{Succes=TODO}}" />

					<div class="row">
					<button class="mf weapon-roll-button" type="roll" value=" @{ArmesRollTemplate} @{ArmesRoll}">
					</button>
						<select name="attr_ArmesSkill" title="Compétence de l'arme" class="auto">
							<option value=""></option>
							<option value="Melee">Mêlée</option>
							<option value="ArmesdeJet">Armes de jet</option>
							<option value="ArmesLourdes">Armes lourdes</option>
							<option value="ArmesDePoing">Armes de poing</option>
							<option value="ArmesDEpaule">Armes d'épaule</option>
							<option value="ArmesEmbarquee">Armes embarquées</option>
						</select>
						<input type="text" name="attr_ArmesNom" placeholder="Armes" title="Nom de l'arme">
						<input type="text" name="attr_ArmesDegat" placeholder="Dégât" title="Type de dégât" class="degat">
						<select name="attr_ModeDeTir" title="Mode de tir" class="auto">
							<option value=""></option>
							<option value="CC">CC</option>
							<option value="SA">SA</option>
							<option value="RC">RC</option>
							<option value="RL">RL</option>
							<option value="RC/RL">RC/RL</option>
						</select>
						<input type="number" name="attr_ArmesChargeur" value="0" title="Capacité maximal du chargeur" class="great">
						<input type="number" name="attr_ArmesPortee" value="0" title="Portée maximale" class="great">
						<input type="number" name="attr_ArmesNChargeur" value="0" title="Nombre de chargeur">
						<input type="number" name="attr_ArmesMunition" value="0" title="Munitions restantes par chargeur">
						<input type="text" name="attr_ArmesDesc" value="" title="Description de l'arme" style="width: 100%">
					</div>
				</fieldset>
			</div>
		</div>

		<!-- Équipement -->
		<div class="row">
			<!-- Equipement -->
			<div class="flex-grow1">
				<div class="column-header">Équipement</div>
				<div class="flex-grow1">
					<fieldset class="repeating_Equipement">
						<input type="text" name="attr_Equipement" placeholder="Equipement" class="fill">
					</fieldset>
				</div>
				<div class="column-subheader">
					<span>Crédits </span>
				</div>
				<input type="number great" name="attr_Credits" placeholder="Credits" class="fill">
			</div>
		</div>

		<!-- Mutations -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Mutations</div>
				<fieldset class="repeating_Mutation">
					<div class="row">
						<input type="text" name="attr_Mutation" placeholder="Nom" title="Nom">
						<select name="attr_MutationType" class="auto">
							<option value="Basique" title="Basique">Basique</option>
							<option value="Avancee" title="Avancée">Avancée</option>
						</select>
						<select name="attr_MutationActivation" class="auto">
							<option value="Passive" title="Passive">Passive</option>
							<option value="Activee" title="Activée">Activée</option>
						</select>
						<input type="text" name="attr_MutationEffet" placeholder="Effet" title="Effet" style="width: 100%">
					</div>
				</fieldset>
			</div>
		</div>

		<!-- Spécialités -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Spécialités</div>
				<fieldset class="repeating_Specialite">
					<input type="text" name="attr_Specialite" placeholder="Spécialité" title="Spécialité" class="fill">
				</fieldset>
			</div>
		</div>

		<!-- Traits -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Traits et aptitudes</div>
				<fieldset class="repeating_Trait">
					<div class="row">
						<select name="attr_TraitType" class="auto">
							<option value="Trait">Qualité</option>
							<option value="Defaut">Défaut</option>
							<option value="Defaut">Aptitude</option>
						</select>
						<input type="text" name="attr_TraitNom" placeholder="Nom" title="Nom">
						<input type="number" class="great" name="attr_TraitPoint" placeholder="Point" title="Point">
						<input type="text" name="attr_TraitDescription" placeholder="Description" title="Description" style="width: 100%">
					</div>
				</fieldset>
			</div>
		</div>
	</div>

	<!-- Ship -->
	<div class="charsheet switch-tab-content tab-ship">
		<div class="row">

			<!-- Vaisseau -->
			<div class="flex-grow1">
				<div class="column-header">Vaisseau</div>

				<label> Classe</label>
				<input type="radio" name="attr_shipType" class="ship-commerce" value="Vaisseau de commerce" checked="checked">Vaisseau
				de commerce
				<input type="radio" name="attr_shipType" class="ship-plaisance" value="Vaisseau de plaisance">Vaisseau de plaisance
				<input type="radio" name="attr_shipType" class="ship-militaire" value="Vaisseau militaire">Vaisseau militaire
				<div class="ship-type-content ship-commerce">
					<select name="attr_shipTypeCommerce">
						<option value="Capsule de sauvetage">Capsule de sauvetage (1T)</option>
						<option value="Barge de sauvetage">Barge de sauvetage (10T)</option>
						<option value="Transport léger">Transport léger (100T)</option>
						<option value="Transport lourd">Transport lourd (1000T)</option>
						<option value="Cargo">Cargo (10 000T)</option>
					</select>
				</div>
				<div class="ship-type-content ship-plaisance">
					<select name="attr_shipTypePlaisance">
						<option value="Yacht personnel">Yacht personnel (10T)</option>
						<option value="Yacht">Yacht (100T)</option>
						<option value="Yacht de luxe">Yacht de luxe (1000T)</option>
						<option value="Vaisseau de croisière">Vaisseau de croisière (10 000T)</option>
					</select>
				</div>
				<div class="ship-type-content ship-militaire">
					<select name="attr_shipTypeMilitaire">
						<option value="Vaisseau d’abordage">Vaisseau d’abordage (1T)</option>
						<option value="Chasseur">Chasseur (10T)</option>
						<option value="Corvette">Corvette (100T)</option>
						<option value="Frégate">Frégate (1000T)</option>
						<option value="Cuirassé">Cuirassé (10 000T)</option>
						<option value="Croiseur">Croiseur (100 000T)</option>
					</select>
				</div>

				<div class="block">
					<label>Manœuvrabilité :&nbsp;</label>
					<select name="attr_shipManoeuvrabilite" class="auto">
						<option value="-">-</option>
						<option value="sc">sc</option>
						<option value="e2f">e2f</option>
					</select>
				</div>

				<div class="block">
					<label>Vitesse tactique :&nbsp;</label>
					<input type="number" name="attr_shipVitesseTactique" class="great"> K/t
				</div>

				<div class="block">
					<label>Vitesse de croisière :&nbsp;</label>
					<input type="number" name="attr_shipVitesseCroisiere" class="great" step="0.01"> US/h
					(<input type="number" name="attr_shipVitesseCroisiereJour" step="0.01" class="great"> US/j)
				</div>

				<div class="block">
					<label>Vitesse hyperspatiale :&nbsp;</label>
					<input type="number" name="attr_shipVitesseHyperspatiale" class="great"> PC/j
				</div>

				<div class="block">
					<label>Autonomie :&nbsp;</label>
					<input type="number" name="attr_shipAutonomie" class="great100"> PC
				</div>

				<div class="block">
					<label>Blindage :&nbsp;</label>
					<input type="number" name="attr_shipBlindage">
				</div>

				<div class="block">
					<label>Coque :&nbsp;</label>
					<input type="number" name="attr_shipCoque">
				</div>

				<div class="block">
					<label>Senseurs :&nbsp;</label>
					<input type="number" name="attr_shipSenseursK" class="great"> K
					(<input type="number" name="attr_shipSenseursUs" class="great" step="0.01"> US)
				</div>


				<div class="block">
					<label>Soute :&nbsp;</label>
					<input type="number" name="attr_shipSoute" class="great100"> t
				</div>

				<div class="block">
					<label>Prix :&nbsp;</label>
					<input type="number" name="attr_shipPrix" class="great100"> ¢
				</div>

				<div class="block">
					<label>Origine :&nbsp;</label>
					<select name="attr_shipOrigine" class="auto">
						<option value="OCG">OCG</option>
						<option value="EdS">Empire de Sol</option>
						<option value="EG">Empire galactique</option>
						<option value="LPL">Ligue des planètes libres</option>
						<option value="B">Barrens</option>
						<option value="p">Pirates</option>
						<option value="C">Custom</option>
						<option value="A">Autre</option>
					</select>
				</div>
			</div>

			<!-- Santé -->
			<div class="flex-grow1">
				<div class="row">
					<div class="flex-grow2 column-header">Santé</div>
				</div>

				<div class="row">
					<div class="flex-grow1 flex-right">
						<input class="number-title" value="Réel" readonly>
						<input class="number-title" value="Max" readonly>
					</div>
				</div>

				<div class="row">
					<div class="flex-grow1"><label>Indemne</label></div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_shipIndemne" value="0">
						<input type="number" name="attr_shipIndemne_max">
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1"><label>Blessé léger</label></div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_shipBlesseLeger" value="0">
						<input type="number" name="attr_shipBlesseLeger_max">
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1"><label>Blessé grave</label></div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_shipBlesseGrave" value="0">
						<input type="number" name="attr_shipBlesseGrave_max">
					</div>
				</div>
				<div class="row">
					<div class="flex-grow1"><label>Mort ?</label></div>
					<div class="flex-grow1 flex-right">
						<input type="number" name="attr_shipMort" value="0">
						<input type="number" name="attr_shipMort_max">
					</div>
				</div>
			</div>
		</div>

		<!-- Modules secondaires -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Modules secondaires</div>
				<div class="row">
					<input type="text" value="Nom" readonly>
					<input type="text" value="Effet" style="width: 100%" readonly>
					<input type="text" value="Tonnage" class="great" readonly>
				</div>
				<fieldset class="repeating_shipModSecondaires">
					<div class="row">
						<input type="text" name="attr_shipModSecondairesNom" title="Nom">
						<input type="text" name="attr_shipModSecondairesEffet" title="Effet" style="width: 100%">
						<input type="number" name="attr_shipModSecondairesTonnage" title="Tonnage" class="great">
					</div>
				</fieldset>
			</div>
		</div>

		<!-- Armes -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Armes</div>
				<fieldset class="repeating_shipArmes">
					<select name="attr_shipPosition" title="Position" class="auto">
						<option value="Pr">Proue (Pr)</option>
						<option value="P">Poupe (P)</option>
						<option value="Po">Pont (Po)</option>
						<option value="V">Ventre (V)</option>
						<option value="B">Bâbord (B)</option>
						<option value="T">Tribord (T)</option>
					</select>
					<input type="number" name="attr_shipArmesNombre" title="Nombre de canon"> X
					<input type="text" name="attr_shipArmesNom" placeholder="Armes" title="Nom de l'arme" style="width:390px">
					<input type="text" name="attr_shipArmesDegat" placeholder="Dégât" title="Type de dégât" class="degat great">
					<select name="attr_shipModeDeTir" title="Mode de tir" class="auto">
						<option value="CC">CC</option>
						<option value="SA">SA</option>
						<option value="RC">RC</option>
						<option value="RL">RL</option>
						<option value="RC/RL">RC/RL</option>
					</select>
					<input class="great" type="number" name="attr_shipArmesPortee" value="0" title="Portée maximale">
					<input type="text" name="attr_shipArmesEquipageMin" placeholder="Equipage minimum" title="Equipage minimum" class="great100">
				</fieldset>
			</div>
		</div>

		<!-- Équipage -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Équipage</div>
				<fieldset class="repeating_shipEquipage">
					<input type="number" name="attr_shipEquipageNombre" title="Nombre nécessaire" class="great"> X
					<select name="attr_shipPoste" title="Poste" class="auto">
						<option value="P">Pilote (P)</option>
						<option value="V">Vigie (V)</option>
						<option value="C">Cannonier (C)</option>
						<option value="Me">Mecanicien (Me)</option>
						<option value="Ma">Matelot (Ma)</option>
						<option value="Ca">Cabine</option>
						<option value="Do">Dortoire</option>
						<option value="MaxP">Nombre Maximum de personnes</option>
						<option value="S">Soute</option>
					</select>
					(<input type="number" name="attr_shipEquipageNombre_max" title="Nombre maximum" class="great">)
				</fieldset>
			</div>
		</div>

		<!-- Soute -->
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Soute</div>
				<div class="block">
					<label>Restant :</label>
					<input type="number" name="attr_shipSouteTonnageReste" class="great" readonly>
				</div>

				<div class="row">
					<input type="text" value="Nom" style="width: 100%" readonly>
					<input type="text" value="Tonnage" class="great" readonly>
					<input type="text" value="Quantité" class="great" readonly>
				</div>
				<fieldset class="repeating_shipSoute">
					<div class="row">
						<input type="text" name="attr_shipSouteItem" title="Nom" style="width: 100%">
						<input type="number" name="attr_shipSouteTonnage" title="Tonnage" class="great">
						<input type="number" name="attr_shipSouteQuantite" title="Quantité" class="great">
					</div>
				</fieldset>
			</div>
		</div>
	</div>

	<!-- Param -->
	<div class="charsheet switch-tab-content tab-param">
		<div class="row">
			<div class="flex-grow1">
				<div class="column-header">Modificateurs de jet</div>

				<div class="row">
					<button type="roll" name="roll_GPMF" class="btn" value="@{MAd6RollMod} {{title=(PMF) Grand peut mieux faire}} {{Succès en plus=[[?{Nombre de succès ?}d6>@{roll_success_diff}]]}}">
						PMF
					</button>
				</div>
				<div class="row">
					<button type="roll" name="roll_GSC" class="btn" value="@{MAd6RollMod} {{title=(SC) Grand seconde chance}} {{Succès en plus=[[?{Nombre d'échecs ?}d6>@{roll_success_diff}]]}}">
						SC
					</button>
				</div>
				<div class="row">
					<button type="roll" name="roll_GE2F" class="btn" value="@{MAd6RollMod} {{title=(E2F) Grand essaie encore une fois}} {{Succès finaux=[[?{Nombre de succès ?}d6>@{roll_success_diff}]]}}">
						E2F
					</button>
				</div>
				<div class="row">
					<button type="roll" name="roll_ppmf" class="btn" value="@{MAd6RollMod} {{title=(pmf) Petit peut mieux faire}} {{Succès en plus=[[1d6>@{roll_success_diff}]]}}">
						pmf
					</button>
				</div>
				<div class="row">
					<button type="roll" name="roll_psc" class="btn" value="@{MAd6RollMod} {{title=(sc) Petit seconde chance}} {{Succès en plus=[[1d6>@{roll_success_diff}]]}}">
						sc
					</button>
				</div>
				<div class="row">
					<button type="roll" name="roll_pe2f" class="btn" value="@{MAd6RollMod} {{title=(e2f) Petit essaie encore une fois}} {{Succès finaux=[[?{Nombre de succès ?}-1d6<[[@{roll_success_diff}-1]]]]}}">
						e2f
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<rolltemplate class="sheet-rolltemplate-MA">
	<div class="sheet-container sheet-color-{{color}}">
      <div class="sheet-header">
        {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
        {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
      </div>
      <div class="sheet-content">
        {{#allprops() title subtitle desc color MF buttons}}
        	<div class="sheet-key">{{key}}</div>
        	<div class="sheet-value">{{value}}</div>
        {{/allprops() title subtitle desc color MF buttons}}
        {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
		{{#MF}}
			<div class="sheet-key">MF</div>
			<div class="sheet-value">{{MF}}</div>
		{{/MF}}
      </div>
	  {{#buttons}}<div class="sheet-btn">{{buttons}}</div>{{/buttons}}
    </div>
</rolltemplate>

<script type="text/worker">
	on('sheet:opened',function(){
	});

	<!---------------------------------------  PJ  -------------------------------------------------------->
	on("change:Technique change:Acrobatie change:ArmesDePoing change:ArmesDEpaule change:ArmesEmbarquee change:Artisanat change:Pilotage1 change:Pilotage2 change:Technologie", function() {
	    getAttrs(["Technique", "Acrobatie", "ArmesDePoing", "ArmesDEpaule", "ArmesEmbarquee", "Artisanat", "Pilotage1", "Pilotage2", "Technologie"], function(v) {
	       setAttrs({
				Acrobatie_max: +v.Technique + +v.Acrobatie,
				ArmesDePoing_max: +v.Technique + +v.ArmesDePoing,
				ArmesDEpaule_max: +v.Technique + +v.ArmesDEpaule,
				ArmesEmbarquee_max: +v.ArmesEmbarquee > 0 ? +v.Technique + +v.ArmesEmbarquee:0,
				Artisanat_max: +v.Technique + +v.Artisanat,
				Pilotage1_max: +v.Pilotage1>0?+v.Technique + +v.Pilotage1:0,
				Pilotage2_max: +v.Pilotage2>0?+v.Technique + +v.Pilotage2:0,
				Technologie_max: +v.Technique + +v.Technologie
			});
	   });
	});

	on("change:Technique change:repeating_AgiliteSkills", function(eventInfo) {
		getSectionIDs("repeating_AgiliteSkills", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_AgiliteSkills_" + n;
				getAttrs(["Technique", section + "_SkillBase"], function(v) {
					o = {};

					if(v[section + "_SkillBase"] == undefined) {
						v[section + "_SkillBase"] = 0;
					}
					o[section + "_SkillBase_max"] = +v.Technique + +v[section + "_SkillBase"];
					setAttrs(o);
				});
			});
		});
	});

	on("change:Survie change:ArmesdeJet change:ArmesLourdes change:Athletisme change:Equitation change:Melee change:Environement1 change:Environement2 change:Environement3", function() {
	    getAttrs(["Survie", "ArmesdeJet", "ArmesLourdes", "Athletisme", "Equitation", "Melee", "Environement1", "Environement2", "Environement3"], function(v) {
	       setAttrs({
				ArmesdeJet_max: +v.Survie + +v.ArmesdeJet,
				ArmesLourdes_max: +v.ArmesLourdes > 0 ? +v.Survie + +v.ArmesLourdes:0,
				Athletisme_max: +v.Survie + +v.Athletisme,
				Equitation_max: +v.Survie + +v.Equitation,
				Melee_max: +v.Survie + +v.Melee,
				Environement1_max: +v.Survie + +v.Environement1,
				Environement2_max: +v.Survie + +v.Environement2,
				Environement3_max: +v.Survie + +v.Environement3,
			});
	   });
	});

	on("change:Survie change:repeating_CarrureSkills", function(eventInfo) {
		getSectionIDs("repeating_CarrureSkills", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_CarrureSkills_" + n;
				getAttrs(["Survie", section + "_SkillBase"], function(v) {
					o = {};

					if(v[section + "_SkillBase"] == undefined) {
						v[section + "_SkillBase"] = 0;
					}
					o[section + "_SkillBase_max"] = +v.Survie + +v[section + "_SkillBase"];
					setAttrs(o);
				});
			});
		});
	});

	on("change:Espionnage change:Deguisement change:Discretion change:Empathie change:Falsification change:Recherche change:Senseurs change:SysSecu change:Vigilance", function() {
	    getAttrs(["Espionnage", "Deguisement", "Discretion", "Empathie", "Falsification", "Recherche", "Senseurs", "SysSecu", "Vigilance"], function(v) {
	       setAttrs({
				Deguisement_max: +v.Espionnage + +v.Deguisement,
				Discretion_max: +v.Espionnage + +v.Discretion,
				Empathie_max: +v.Espionnage + +v.Empathie,
				Falsification_max: +v.Falsification > 0 ? +v.Espionnage + +v.Falsification:0,
				Recherche_max: +v.Espionnage + +v.Recherche,
				Senseurs_max: +v.Senseurs > 0 ? +v.Espionnage + +v.Senseurs:0,
				SysSecu_max: +v.SysSecu > 0 ? +v.Espionnage + +v.SysSecu:0,
				Vigilance_max: +v.Espionnage + +v.Vigilance,
			});
	   });
	});

	on("change:Espionnage change:repeating_PerceptionSkills", function(eventInfo) {
		getSectionIDs("repeating_PerceptionSkills", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_PerceptionSkills_" + n;
				getAttrs(["Espionnage", section + "_SkillBase"], function(v) {
					o = {};

					if(v[section + "_SkillBase"] == undefined) {
						v[section + "_SkillBase"] = 0;
					}
					o[section + "_SkillBase_max"] = +v.Espionnage + +v[section + "_SkillBase"];
					setAttrs(o);
				});
			});
		});
	});

	on("change:Science change:Analyse change:Art change:Connaissance1 change:Connaissance2 change:Connaissance3 change:Esoterisme change:Histoire change:Ingenierie change:Medecine change:Navigation change:SciencesSolaires change:SciencesStellaires change:Strategie", function() {
	    getAttrs(["Science", "Analyse", "Art", "Connaissance1", "Connaissance2", "Connaissance3", "Esoterisme", "Histoire", "Ingenierie", "Medecine", "Navigation", "SciencesSolaires", "SciencesStellaires", "Strategie"], function(v) {
	       setAttrs({
				Analyse_max: +v.Science + +v.Analyse,
				Art_max: +v.Science + +v.Art,
				Connaissance1_max: +v.Science + +v.Connaissance1,
				Connaissance2_max: +v.Science + +v.Connaissance2,
				Connaissance3_max: +v.Science + +v.Connaissance3,
				Esoterisme_max: +v.Esoterisme > 0 ? +v.Science + +v.Esoterisme:0,
				Histoire_max: +v.Science + +v.Histoire,
				Ingenierie_max: +v.Ingenierie > 0 ? +v.Science + +v.Ingenierie:0,
				Medecine_max: +v.Medecine > 0 ? +v.Science + +v.Medecine:0,
				Navigation_max: +v.Science + +v.Navigation,
				SciencesSolaires_max: +v.SciencesSolaires > 0 ? +v.Science + +v.SciencesSolaires:0,
				SciencesStellaires_max: +v.SciencesStellaires > 0 ? +v.Science + +v.SciencesStellaires:0,
				Strategie_max: +v.Strategie > 0 ? +v.Science + +v.Strategie:0,
			});
	   });
	});

	on("change:Science change:repeating_ScienceSkills", function(eventInfo) {
		getSectionIDs("repeating_ScienceSkills", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_ScienceSkills_" + n;
				getAttrs(["Science", section + "_SkillBase"], function(v) {
					o = {};

					if(v[section + "_SkillBase"] == undefined) {
						v[section + "_SkillBase"] = 0;
					}
					o[section + "_SkillBase_max"] = +v.Science + +v[section + "_SkillBase"];
					setAttrs(o);
				});
			});
		});
	});

	on("change:Negociation change:Baration change:Bureaucratie change:Comedie change:Commerce change:Danse change:Eloquence change:Etiquette change:Jeux change:Seduction", function() {
	    getAttrs(["Negociation", "Baration", "Bureaucratie", "Comedie", "Commerce", "Danse", "Eloquence", "Etiquette", "Jeux", "Seduction"], function(v) {
	       setAttrs({
				Baration_max: +v.Negociation + +v.Baration,
				Bureaucratie_max: +v.Negociation + +v.Bureaucratie,
				Comedie_max: +v.Negociation + +v.Comedie,
				Commerce_max: +v.Negociation + +v.Commerce,
				Danse_max: +v.Negociation + +v.Danse,
				Eloquence_max: +v.Negociation + +v.Eloquence,
				Etiquette_max: +v.Negociation + +v.Etiquette,
				Jeux_max: +v.Negociation + +v.Jeux,
				Seduction_max: +v.Negociation + +v.Seduction,
			});
	   });
	});

	on("change:Negociation change:repeating_PresenceSkills", function(eventInfo) {
		getSectionIDs("repeating_PresenceSkills", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_PresenceSkills_" + n;
				getAttrs(["Negociation", section + "_SkillBase"], function(v) {
					o = {};

					if(v[section + "_SkillBase"] == undefined) {
						v[section + "_SkillBase"] = 0;
					}
					o[section + "_SkillBase_max"] = +v.Negociation + +v[section + "_SkillBase"];
					setAttrs(o);
				});
			});
		});
	});

	on("change:Trempe change:Commandement change:Demolition change:Determination change:Dressage change:Illegalites change:Intimidation change:Premierssoins change:Tactique change:Jeux change:Seduction", function() {
	    getAttrs(["Trempe", "Commandement", "Demolition", "Determination", "Dressage", "Illegalites", "Intimidation", "Premierssoins", "Tactique", "Jeux", "Seduction"], function(v) {
	       setAttrs({
				Commandement_max: +v.Trempe + +v.Commandement,
				Demolition_max: +v.Demolition > 0 ? +v.Trempe + +v.Demolition:0,
				Determination_max: +v.Trempe + +v.Determination,
				Dressage_max: +v.Trempe + +v.Dressage,
				Illegalites_max: +v.Trempe + +v.Illegalites,
				Intimidation_max: +v.Trempe + +v.Intimidation,
				Premierssoins_max: +v.Trempe + +v.Premierssoins,
				Tactique_max: +v.Trempe + +v.Tactique,
			});
	   });
	});

	on("change:Negociation change:repeating_SangfroidSkills", function(eventInfo) {
		getSectionIDs("repeating_SangfroidSkills", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_SangfroidSkills_" + n;
				getAttrs(["Trempe", section + "_SkillBase"], function(v) {
					o = {};

					if(v[section + "_SkillBase"] == undefined) {
						v[section + "_SkillBase"] = 0;
					}
					o[section + "_SkillBase_max"] = +v.Trempe + +v[section + "_SkillBase"];
					setAttrs(o);
				});
			});
		});
	});

	on("change:Trempe change:Survie change:repeating_pnjSante", function() {
	    getAttrs(["Trempe", "Survie"], function(v) {
			var s = +v.Survie;
			var t = +v.Trempe + s;
			var m = 0;
			if(s <= 2) m = 1;
			else if(s <= 4) m = 2;
			else if(s <= 6) m = 3;
			else if(s <= 9) m = 5;
			else if(s <= 15) m = 8;
			else if(s > 15) m = 10;
	       setAttrs({
				Indemne_max: t,
				BlesseLeger_max: t,
				BlesseGrave_max: t,
				Mort_max: t,
				ArmesMainNues: `${m}S`
			});
   		});

	//    <!-- For PNJ -->
		getSectionIDs("repeating_pnjSante", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_pnjSante_" + n;
				getAttrs(["Trempe", "Survie"], function(v) {
					var value = +v.Trempe + +v.Survie;

					var o = {};
					o[section + "_pnjIndemne_max"] = value;
					o[section + "_pnjBlesseLeger_max"] = value;
					o[section + "_pnjBlesseGrave_max"] = value;
					o[section + "_pnjMort_max"] = value;
					setAttrs(o);
	            });
	        });
	   });
	});

	// // TODO il existe des traits pour avoir une EX différente
	on("change:Espionnage change:Science", function() {
	    getAttrs(["Espionnage", "Science", "EnergieX"], function(v) {
	       setAttrs({
				EnergieX: Math.min( +v.EnergieX, +v.Espionnage + +v.Science),
				EnergieX_max: +v.Espionnage + +v.Science
			});
	   });
	});

	on("change:Gloire", function() {
	    getAttrs(["Gloire", "GloireBonus"], function(v) {
	       setAttrs({
				GloireBonus: Math.floor(+v.Gloire/2)
			});
	   });
	});

	on("change:Experience_max", function() {
	    getAttrs(["Experience", "Experience_max", "Experience_precedente"], function(v) {
	       setAttrs({
				Experience: +v.Experience + +v.Experience_max - +v.Experience_precedente,
				Experience_precedente: v.Experience_max,
			});
	   });
	});

	on("change:repeating_Armes", function(eventInfo) {
		getSectionIDs("repeating_Armes", function(ids) {
			_.each(ids, function(n) {
				var section = "repeating_Armes_" + n;
				getAttrs([section + "_ArmesSkill"], function(v) {
					setAttrs({
						[section + "_ArmesRoll"]: "{{Succès=[[@{"+v[section + "_ArmesSkill"]+"|max}d6>@{roll_success_diff}]]}}"
					});
				});
		    });
		});
	});

	<!----------------------------------------------------------------------------------------------------->

	<!---------------------------------------  Ship  ------------------------------------------------------>

	on("change:shipCoque", function() {
	    getAttrs(["shipCoque"], function(v) {
	       setAttrs({
			  shipIndemne_max: +v.shipCoque,
			  shipBlesseLeger_max: +v.shipCoque,
			  shipBlesseGrave_max: +v.shipCoque,
			  shipMort_max: +v.shipCoque,
			});
	   });
	});

	on("change:shipSoute change:repeating_shipSoute change:repeating_shipModSecondaires", function() {
		// SOUTE
		getSectionIDs("repeating_shipSoute", function(ids) {
			var sumSoute = 0;
			_.each(ids, function(n) {
				var section = "repeating_shipSoute_" + n;
				getAttrs([section + "_shipSouteTonnage", section + "_shipSouteQuantite"], function(v) {

					// secu
					if(v[section + "_shipSouteTonnage"] == undefined){
						v[section + "_shipSouteTonnage"] = 0;
					}
					if(v[section + "_shipSouteQuantite"] == undefined){
						v[section + "_shipSouteQuantite"] = 0;
					}

					// calcul
					sumSoute = sumSoute + (+v[section + "_shipSouteTonnage"]) * (+v[section + "_shipSouteQuantite"]);
				});
			});

			// MOD
			getSectionIDs("repeating_shipModSecondaires", function(ids) {
				var sumMod = 0;
				_.each(ids, function(n) {
					var section = "repeating_shipModSecondaires_" + n;
					getAttrs([section + "_shipModSecondairesTonnage"], function(v) {
						if(v[section + "_shipModSecondairesTonnage"] == undefined){
							v[section + "_shipModSecondairesTonnage"] = 0;
						}
						sumMod = sumMod + +v[section + "_shipModSecondairesTonnage"];
					});
				});

				// SET
				getAttrs(["shipSoute"], function(v) {
					console.log("SOUTE2 set valueMOD %d", sumMod);
					console.log("SOUTE2 set valueSOUTE %d", sumSoute);
					if(v.shipSoute == undefined) {
						v.shipSoute = 0;
					}
					setAttrs({
					  shipSouteTonnageReste: +v.shipSoute - +sumMod - +sumSoute,
					});
				});
			});
		});
	});

	<!----------------------------------------------------------------------------------------------------->

</script>
<!--  FOOTER -->

<div class="sheet-container">
    <div class="sheet-main">
        <div class="sheet-float sheet-half">
            <div class="sheet-row">
                <label class="sheet-redbg" for="attr_character_name">Charaktername</label><input type="text"
                    name="attr_character_name">
            </div>
            <div class="sheet-row">
                <div class="sheet-ep">
                    <label for="attr_EP">EP</label><input type="number" name="attr_EP" />
                    <label for="attr_Stufe">Stufe</label><input type="number" name="attr_Stufe" readOnly />
                    <label for="attr_AP">AP</label><input type="number" name="attr_AP" />
                </div>
                <div class="sheet-vermoegen">
                    <label for="attr_GF">GF</label><input type="number" name="attr_GF" />
                    <label for="attr_TT">TT</label><input type="number" name="attr_TT" />
                    <label for="attr_KL">KL</label><input type="number" name="attr_KL" />
                    <label for="attr_MU">MU</label><input type="number" name="attr_MU" />
                </div>
            </div>
            <div class="sheet-row">
                <div class="sheet-stats">
                    <label for="attr_leben">Leben</label>
                    <div>
                        <input type="number" name="attr_leben" placeholder="Aktuell" /> / <input type="number"
                            name="attr_leben_max" />
                    </div>
                    <label for="attr_ruestung">Rüstung</label><input type="number" name="attr_ruestung" />
                </div>
                <div class="sheet-gmroll">
                    <select name="attr_gmroll">
                        <option value="nogm" selected="selected">Für alle sichtbar w&uuml;rfeln</option>
                        <option value="gm">Für GM w&uuml;rfeln</option>
                    </select>
                    <input type="hidden" name="attr_abilityroll" />
                </div>
            </div>
        </div>
        <div class="sheet-float sheet-half">
            <div class="sheet-row">
                <label class="sheet-redbg" for="attr_SpielerName">Spieler-Name</label><input type="text"
                    name="attr_SpielerName">
            </div>
            <div class="sheet-row">
                <label class="sheet-redbg" for="attr_Volk">Volk</label><input type="text" name="attr_Volk">
            </div>
            <div class="sheet-row">
                <label class="sheet-redbg" for="attr_Beruf">Beruf</label><input type="text" name="attr_Beruf">
            </div>
        </div>

        <div class="sheet-clear"></div>

        <div class="sheet-grid">
        </div>
        <div class="sheet-float sheet-half sheet-attribut">
            <div class="sheet-grid">
                <div>Attribut</div>
                <div>Wert</div>
                <div style="background-color: transparent;"></div>
                <div>Bonus</div>
                <div>Roll</div>
            </div>
            <div class="sheet-gridplace">

                <div class="repcontainer">
                    <div class="repitem">
                        <div class="sheet-name" for="attr_ST"><strong>St</strong>ärke</div>
                        <input type="number" name="attr_ST" />
                        <div class="sheet-arrow"></div>
                        <input type="number" name="attr_STB" readOnly />
                        <button type="roll" name="roll_ST"
                            value="@{abilityroll} versucht sich in Stärke [[1d10! + @{STB} + ?{Modifier?|0}]]"></button>

                        <div class="sheet-name" for="attr_GE"><strong>Ge</strong>schicklichkeit</div>
                        <input type="number" name="attr_GE" />
                        <div class="sheet-arrow"></div>
                        <input type="number" name="attr_GEB" readOnly />
                        <button type="roll" name="roll_GE"
                            value="@{abilityroll} versucht sich in Geschicklichkeit [[1d10! + @{GEB} + ?{Modifier?|0}]]"></button>

                        <div class="sheet-name" for="attr_KO"><strong>Ko</strong>nstitution</div>
                        <input type="number" name="attr_KO" />
                        <div class="sheet-arrow"></div>
                        <input type="number" name="attr_KOB" readOnly />
                        <button type="roll" name="roll_KO"
                            value="@{abilityroll} versucht sich in Konstitution [[1d10! + @{KOB} + ?{Modifier?|0}]]"></button>

                        <div class="sheet-name" for="attr_IN"><strong>In</strong>telligenz</div>
                        <input type="number" name="attr_IN" />
                        <div class="sheet-arrow"></div>
                        <input type="number" name="attr_INB" readOnly />
                        <button type="roll" name="roll_IN"
                            value="@{abilityroll} versucht sich in Intelligenz [[1d10! + @{INB} + ?{Modifier?|0}]]"></button>

                        <div class="sheet-name" for="attr_CH"><strong>Ch</strong>arisma</div>
                        <input type="number" name="attr_CH" />
                        <div class="sheet-arrow"></div>
                        <input type="number" name="attr_CHB" readOnly />
                        <button type="roll" name="roll_CH"
                            value="@{abilityroll} versucht sich in Charisma [[1d10! + @{CHB} + ?{Modifier?|0}]]"></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="sheet-float sheet-half">
            <div class="sheet-row sheet-small">
                <div class="sheet-gott">
                    <div>Göttliche Chance / Punkte</div>
                    <input type="checkbox" name="attr_1" />
                    <input type="checkbox" name="attr_2" />
                    <input type="checkbox" name="attr_3" />
                    <input type="checkbox" name="attr_4" />
                    <input type="checkbox" name="attr_5" />
                </div>
                <div class="sheet-mana">
                    <label for="attr_mana">Mana</label>
                    <div>
                        <input type="number" name="attr_mana" placeholder="Aktuell" /> / <input type="number"
                            name="attr_mana_max" />
                    </div>
                </div>
            </div>

            <div class="sheet-row sheet-small sheet-magie">
                <div class="sheet-grid">
                    <div>Magie</div>
                    <div>Attr.</div>
                    <div>Wert</div>
                    <div>Roll</div>
                </div>
                <div class="sheet-gridplace">
                    <div class="repcontainer">
                        <div class="repitem">
                            <div>Magie entwickeln</div>
                            <div>
                                <select name="attr_mag_attribut">
                                    <option value="@{STB}">ST</option>
                                    <option value="@{GEB}">GE</option>
                                    <option value="@{KOB}">KO</option>
                                    <option value="@{INB}" selected>IN</option>
                                    <option value="@{CHB}">CH</option>
                                </select>
                            </div>
                            <div><input type="number" name="attr_mag" value="0"></div>
                            <div></div>
                        </div>
                        <div class="repitem">
                            <div>Gezielte Sprüche</div>
                            <div>
                                <select name="attr_gezsp_attribut">
                                    <option value="@{STB}">ST</option>
                                    <option value="@{GEB}">GE</option>
                                    <option value="@{KOB}">KO</option>
                                    <option value="@{INB}" selected>IN</option>
                                    <option value="@{CHB}">CH</option>
                                </select>
                            </div>
                            <div><input type="number" name="attr_gezsp" value="0"></div>
                            <div><button type="roll" name="roll_gezsp"
                                    value="@{abilityroll} wirkt einen geziehlten Zauber mit dem Ergebnis [[1d10! + @{gezsp_attribut} + @{gezsp} + ?{Modifier?|0}]]"></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="sheet-clear"></div>

        <div class="sheet-float sheet-half sheet-fertigkeiten">
            <div class="sheet-grid">
                <div>Fertigkeit</div>
                <div>Attr.</div>
                <div>Wert</div>
                <div>Roll</div>
            </div>
            <div class="sheet-gridplace">

                <div class="repcontainer">
                    <div class="repitem">
                        <div>Athletik</div>
                        <div>
                            <select name="attr_athletik_attribut">
                                <option value="@{STB}">ST</option>
                                <option value="@{GEB}" selected>GE</option>
                                <option value="@{KOB}">KO</option>
                                <option value="@{INB}">IN</option>
                                <option value="@{CHB}">CH</option>
                            </select>
                        </div>
                        <div><input type="number" name="attr_athletik" value="0"></div>
                        <div><button type="roll" name="roll_athletik"
                                value="@{abilityroll} würfelt Athletik mit dem Ergebnis [[1d10! + @{athletik_attribut} + @{athletik} + ?{Modifier?|0}]]"></button>
                        </div>
                    </div>
                    <div class="repitem">
                        <div>Einflussnahme</div>
                        <div>
                            <select name="attr_einflussnahme_attribut">
                                <option value="@{STB}">ST</option>
                                <option value="@{GEB}">GE</option>
                                <option value="@{KOB}">KO</option>
                                <option value="@{INB}">IN</option>
                                <option value="@{CHB}" selected>CH</option>
                            </select>
                        </div>
                        <div><input type="number" name="attr_einflussnahme" value="0"></div>
                        <div><button type="roll" name="roll_einflussnahme"
                                value="@{abilityroll} würfelt Einflussnahme mit dem Ergebnis [[1d10! + @{einflussnahme_attribut} + @{einflussnahme} + ?{Modifier?|0}]]"></button>
                        </div>
                    </div>
                    <div class="repitem">
                        <div>List</div>
                        <div>
                            <select name="attr_list_attribut">
                                <option value="@{STB}">ST</option>
                                <option value="@{GEB}" selected>GE</option>
                                <option value="@{KOB}">KO</option>
                                <option value="@{INB}">IN</option>
                                <option value="@{CHB}">CH</option>
                            </select>
                        </div>
                        <div><input type="number" name="attr_list" value="0"></div>
                        <div><button type="roll" name="roll_list"
                                value="@{abilityroll} würfelt List mit dem Ergebnis [[1d10! + @{athletik_attribut} + @{athletik} + ?{Modifier?|0}]]"></button>
                        </div>
                    </div>
                    <div class="repitem">
                        <div>Natur</div>
                        <div>
                            <select name="attr_natur_attribut">
                                <option value="@{STB}">ST</option>
                                <option value="@{GEB}" selected>GE</option>
                                <option value="@{KOB}">KO</option>
                                <option value="@{INB}">IN</option>
                                <option value="@{CHB}">CH</option>
                            </select>
                        </div>
                        <div><input type="number" name="attr_natur" value="0"></div>
                        <div><button type="roll" name="roll_natur"
                                value="@{abilityroll} würfelt Natur mit dem Ergebnis [[1d10! + @{natur_attribut} + @{natur} + ?{Modifier?|0}]]"></button>
                        </div>
                    </div>
                    <div class="repitem">
                        <div>Reiten</div>
                        <div>
                            <select name="attr_reiten_attribut">
                                <option value="@{STB}">ST</option>
                                <option value="@{GEB}" selected>GE</option>
                                <option value="@{KOB}">KO</option>
                                <option value="@{INB}">IN</option>
                                <option value="@{CHB}">CH</option>
                            </select>
                        </div>
                        <div><input type="number" name="attr_reiten" value="0"></div>
                        <div><button type="roll" name="roll_reiten"
                                value="@{abilityroll} würfelt Reiten mit dem Ergebnis [[1d10! + @{reiten_attribut} + @{reiten} + ?{Modifier?|0}]]"></button>
                        </div>
                    </div>
                    <div class="repitem">
                        <div>Schwimmen</div>
                        <div>
                            <select name="attr_schwimmen_attribut">
                                <option value="@{STB}">ST</option>
                                <option value="@{GEB}" selected>GE</option>
                                <option value="@{KOB}">KO</option>
                                <option value="@{INB}">IN</option>
                                <option value="@{CHB}">CH</option>
                            </select>
                        </div>
                        <div><input type="number" name="attr_schwimmen" value="0"></div>
                        <div><button type="roll" name="roll_schwimmen"
                                value="@{abilityroll} würfelt Schwimmen mit dem Ergebnis [[1d10! + @{schwimmen_attribut} + @{schwimmen} + ?{Modifier?|0}]]"></button>
                        </div>
                    </div>
                    <div class="repitem">
                        <div>Wahrnehmung</div>
                        <div>
                            <select name="attr_wa_attribut">
                                <option value="@{STB}">ST</option>
                                <option value="@{GEB}">GE</option>
                                <option value="@{KOB}">KO</option>
                                <option value="@{INB}" selected>IN</option>
                                <option value="@{CHB}">CH</option>
                            </select>
                        </div>
                        <div><input type="number" name="attr_wa" value="0"></div>
                        <div><button type="roll" name="roll_wa"
                                value="@{abilityroll} würfelt Wahrnehmung mit dem Ergebnis [[1d10! + @{wa_attribut} + @{wa} + ?{Modifier?|0}]]"></button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="sheet-float sheet-half sheet-fertigkeiten">
            <div class="sheet-grid">
                <div>Fertigkeit</div>
                <div>Attr.</div>
                <div>Wert</div>
                <div>Roll</div>
            </div>
            <div class="sheet-gridplace">
                <fieldset class="repeating_fertigkeiten">
                    <div><input class="sheet-textcenter" type="text" name="attr_fertigkeit_name" /></div>
                    <div>
                        <select name="attr_fertigkeit_attribut">
                            <option value="@{STB}">ST</option>
                            <option value="@{GEB}">GE</option>
                            <option value="@{KOB}">KO</option>
                            <option value="@{INB}">IN</option>
                            <option value="@{CHB}">CH</option>
                        </select>
                    </div>
                    <div><input type="number" name="attr_fertigkeit_value" value="0" /></div>
                    <div><button type="roll" name="roll_skill"
                            value="@{abilityroll} würfelt @{fertigkeit_name} mit dem Ergebnis [[1d10! +@{fertigkeit_attribut} + @{fertigkeit_value} + ?{Modifier?|0}]]"></button>
                    </div>
                </fieldset>
            </div>
        </div>

        <div class="sheet-clear"></div>

        <div class="sheet-float sheet-kampf">
            <div class="sheet-grid">
                <div>Waffe</div>
                <div>Attribut</div>
                <div>Fertigkeit</div>
                <div>KB</div>
                <div>OB</div>
                <div>Schaden</div>
                <div>Ini-Bonus</div>
                <div>Init.</div>
                <div>Angr.</div>
            </div>
            <div class="sheet-gridplace">
                <fieldset class="repeating_waffen">
                    <div><input class="sheet-textcenter" type="text" name="attr_kampf_waffenname"
                            placeholder="Kurzschwert" /></div>
                    <select name="attr_kampf_attribut">
                        <option value="@{STB}">ST</option>
                        <option value="@{GEB}">GE</option>
                        <option value="@{KOB}">KO</option>
                        <option value="@{INB}">IN</option>
                        <option value="@{CHB}">CH</option>
                    </select>
                    <div><input class="sheet-textcenter" type="text" name="attr_kampf_fertigkeit"
                            placeholder="Kurze Klingenwaffe" /></div>
                    <div><input type="number" name="attr_kampf_kb" value="0" /></div>
                    <div><input type="number" name="attr_kampf_ob" value="0" /></div>
                    <div><input type="number" name="attr_kampf_schaden" value="0" /></div>
                    <div><input type="number" name="attr_kampf_inib" value="0" /></div>
                    <div><button type="roll" name="roll_kampf_init"
                            value="@{abilityroll} nutzt @{kampf_waffenname} \n  mit einer Initiative von [[@{geb} + @{kampf_inib} &{tracker}]]"></button>
                    </div>
                    <div><button type="roll" name="roll_kampf_angr"
                            value="@{abilityroll} greift mit @{kampf_waffenname} an \n würfelt eine [[1d10! + @{kampf_ob} + ?{Kampf-Modifier?|0}]] mit [[@{kampf_schaden} + ?{Schaden-Modifier?|0}]] Schaden. Der DB beträgt [[floor(@{kampf_KB}-@{kampf_OB})]]"></button>
                    </div>
                </fieldset>
            </div>
        </div>

        <div class="sheet-clear"></div>

        <div class="sheet-float sheet-half sheet-inventar">
            <input id="show_textbox" type="checkbox" name="attr_show_textbox" value="1" />
            <div class="sheet-redbg">Inventar</div>
            <fieldset class="repeating_inventar">
                <div class="sheet-options sheet-inventar-row">
                    <input type="text" name="attr_name" placeholder="Gegenstand" />
                    <input type="text" name="attr_wight" placeholder="Gewicht" />
                    <input type="text" name="attr_costs" placeholder="Anzahl" />
                    <textarea name="attr_description" placeholder="Beschreibung"></textarea>
                </div>
            </fieldset>
        </div>

        <div class="sheet-float sheet-half sheet-notes">
            <div class="sheet-redbg">Notizen</div>
            <fieldset class="repeating_notes">
                <div class="sheet-options sheet-notes-row">
                    <input type="text" name="attr_title" placeholder="Titel" />
                    <textarea name="attr_body" placeholder="Inhalt"></textarea>
                </div>

            </fieldset>
        </div>

    </div>
</div>

<!-- worker scripts -->
<script type="text/worker">
    //https://wiki.roll20.net/Sheet_Worker_Scripts#change:.3Cattribute_name.3E
    on("change:gmroll", function(f) {
        getAttrs(["gmroll"], function(v) {
            let rollstring = "/me";
            if (v.gmroll == "nogm")  {
                rollstring = "/me";
            } else if (v.gmroll == "gm") {
                rollstring = "/w GM **@{character_name}**";
            }
            setAttrs({
                abilityroll: rollstring
            });
        });
    });

    on("sheet:opened",function() {
        if (v.readOnly == "1") {
            document.getElementsByClassName('sheet-readOnly').readOnly = true;
        }
    });

    on("change:ST", function() {
        getAttrs(["ST"], function(values) {
            if (values.ST == 1) {
                setAttrs({ STB: -3 });
            }
            if (values.ST == 2) {
                setAttrs({ STB: -2 });
            }
            if (values.ST == 3 || values.ST == 4) {
                setAttrs({ STB: -1 });
            }
            if (values.ST == 5) {
                setAttrs({ STB: 0 });
            }
            if (values.ST == 6 || values.ST == 7) {
                setAttrs({ STB: 1 });
            }
            if (values.ST == 8 || values.ST == 9) {
                setAttrs({ STB: 2 });
            }
            if (values.ST == 10 || values.ST == 11) {
                setAttrs({ STB: 3 });
            }
            if (values.ST == 12 || values.ST == 13) {
                setAttrs({ STB: 4 });
            }
            if (values.ST >= 14) {
                setAttrs({ STB: 5 });
            }
        });
    });

    on("change:GE", function() {
        getAttrs(["GE"], function(values) {
            if (values.GE == 1) {
                setAttrs({ GEB: -3 });
            }
            if (values.GE == 2) {
                setAttrs({ GEB: -2 });
            }
            if (values.GE == 3 || values.GE == 4) {
                setAttrs({ GEB: -1 });
            }
            if (values.GE == 5) {
                setAttrs({ GEB: 0 });
            }
            if (values.GE == 6 || values.GE == 7) {
                setAttrs({ GEB: 1 });
            }
            if (values.GE == 8 || values.GE == 9) {
                setAttrs({ GEB: 2 });
            }
            if (values.GE == 10 || values.GE == 11) {
                setAttrs({ GEB: 3 });
            }
            if (values.GE == 12 || values.GE == 13) {
                setAttrs({ GEB: 4 });
            }
            if (values.GE >= 14) {
                setAttrs({ GEB: 5 });
            }
        });
    });

    on("change:KO", function() {
        getAttrs(["KO"], function(values) {
            if (values.KO == 1) {
                setAttrs({ KOB: -3 });
            }
            if (values.KO == 2) {
                setAttrs({ KOB: -2 });
            }
            if (values.KO == 3 || values.KO == 4) {
                setAttrs({ KOB: -1 });
            }
            if (values.KO == 5) {
                setAttrs({ KOB: 0 });
            }
            if (values.KO == 6 || values.KO == 7) {
                setAttrs({ KOB: 1 });
            }
            if (values.KO == 8 || values.KO == 9) {
                setAttrs({ KOB: 2 });
            }
            if (values.KO == 10 || values.KO == 11) {
                setAttrs({ KOB: 3 });
            }
            if (values.KO == 12 || values.KO == 13) {
                setAttrs({ KOB: 4 });
            }
            if (values.KO >= 14) {
                setAttrs({ KOB: 5 });
            }
        });
    });
    
    on("change:IN", function() {
        getAttrs(["IN"], function(values) {
            if (values.IN == 1) {
                setAttrs({ INB: -3 });
            }
            if (values.IN == 2) {
                setAttrs({ INB: -2 });
            }
            if (values.IN == 3 || values.IN == 4) {
                setAttrs({ INB: -1 });
            }
            if (values.IN == 5) {
                setAttrs({ INB: 0 });
            }
            if (values.IN == 6 || values.IN == 7) {
                setAttrs({ INB: 1 });
            }
            if (values.IN == 8 || values.IN == 9) {
                setAttrs({ INB: 2 });
            }
            if (values.IN == 10 || values.IN == 11) {
                setAttrs({ INB: 3 });
            }
            if (values.IN == 12 || values.IN == 13) {
                setAttrs({ INB: 4 });
            }
            if (values.IN >= 14) {
                setAttrs({ INB: 5 });
            }
        });
    });

    on("change:CH", function() {
        getAttrs(["CH"], function(values) {
            if (values.CH == 1) {
                setAttrs({ CHB: -3 });
            }
            if (values.CH == 2) {
                setAttrs({ CHB: -2 });
            }
            if (values.CH == 3 || values.CH == 4) {
                setAttrs({ CHB: -1 });
            }
            if (values.CH == 5) {
                setAttrs({ CHB: 0 });
            }
            if (values.CH == 6 || values.CH == 7) {
                setAttrs({ CHB: 1 });
            }
            if (values.CH == 8 || values.CH == 9) {
                setAttrs({ CHB: 2 });
            }
            if (values.CH == 10 || values.CH == 11) {
                setAttrs({ CHB: 3 });
            }
            if (values.CH == 12 || values.CH == 13) {
                setAttrs({ CHB: 4 });
            }
            if (values.CH >= 14) {
                setAttrs({ CHB: 5 });
            }
        });
    });

    on("change:EP", function() {
        getAttrs(["EP"], function(values) {
            if (values.EP < 1000) {
                setAttrs({ Stufe: 1 });
            }
            if (values.EP >= 1000 && values.EP < 4000) {
                setAttrs({ Stufe: 2 });
            }
            if (values.EP >= 4000 && values.EP < 8000) {
                setAttrs({ Stufe: 3 });
            }
            if (values.EP >= 8000 && values.EP < 13000) {
                setAttrs({ Stufe: 4 });
            }
            if (values.EP >= 13000 && values.EP < 19000) {
                setAttrs({ Stufe: 5 });
            }
            if (values.EP >= 19000 && values.EP < 26000) {
                setAttrs({ Stufe: 6 });
            }
            if (values.EP >= 26000 && values.EP < 34000) {
                setAttrs({ Stufe: 7 });
            }
            if (values.EP >= 34000 && values.EP < 43000) {
                setAttrs({ Stufe: 8 });
            }
            if (values.EP >= 43000 && values.EP < 53000) {
                setAttrs({ Stufe: 9 });
            }
            if (values.EP >= 53000 && values.EP < 64000) {
                setAttrs({ Stufe: 10 });
            }
            if (values.EP >= 64000 && values.EP < 76000) {
                setAttrs({ Stufe: 11 });
            }
            if (values.EP >= 76000 && values.EP < 89000) {
                setAttrs({ Stufe: 12 });
            }
            if (values.EP >= 89000 && values.EP < 103000) {
                setAttrs({ Stufe: 13 });
            }
            if (values.EP >= 103000 && values.EP < 118000) {
                setAttrs({ Stufe: 14 });
            }
            if (values.EP >= 118000 && values.EP < 134000) {
                setAttrs({ Stufe: 15 });
            }
            if (values.EP >= 134000 && values.EP < 151000) {
                setAttrs({ Stufe: 16 });
            }
            if (values.EP >= 151000 && values.EP < 169000) {
                setAttrs({ Stufe: 17 });
            }
            if (values.EP >= 169000 && values.EP < 188000) {
                setAttrs({ Stufe: 18 });
            }
            if (values.EP >= 188000 && values.EP < 208000) {
                setAttrs({ Stufe: 19 });
            }
            if (values.EP >= 208000) {
                setAttrs({ Stufe: 20 });
            }
        });
    });

    on("change:Beruf change:Stufe change:KOB", function() {
        getAttrs(["KOB", "Beruf", "Stufe"], function(values) {
            if (values.Beruf == "Zauberer" && values.calcLeben == "1") {
                setAttrs({
                    leben_max: Math.floor((4 + parseInt(values.KOB)) * values.Stufe)
                });
            }
            if (values.Beruf == "Barde" || values.Beruf == "Dieb" || values.Beruf == "Schamane" && values.calcLeben == "1") {
                setAttrs({
                    leben_max: Math.floor((6 + parseInt(values.KOB)) * values.Stufe)
                });
            }
            if (values.Beruf == "Priester" || values.Beruf == "Waldläufer" && values.calcLeben == "1") {
                setAttrs({
                    leben_max: Math.floor((8 + parseInt(values.KOB)) * values.Stufe)
                });
            }
            if (values.Beruf == "Krieger" && values.calcLeben == "1") {
                setAttrs({
                    leben_max: Math.floor((10 + parseInt(values.KOB)) * values.Stufe)
                });
            }
        });
    });

    on("change:Beruf change:mag change:CHB change:INB", function() {
        getAttrs(["Beruf", "INB", "CHB", "mag"], function(values) {
            if (values.Beruf == "Dieb" || values.Beruf == "Krieger" || values.Beruf == "Waldläufer" || values.Beruf == "Zauberer") {
                setAttrs({
                    mana_max: Math.floor((parseInt(values.INB) + 3) * values.mag)
                });
            }
            if (values.Beruf == "Barde" || values.Beruf == "Priester" || values.Beruf == "Schamane") {
                setAttrs({
                    mana_max: Math.floor((parseInt(values.CHB) + 3) * values.mag)
                });
            }
        });
    });

    on("change:MU", function() {
        getAttrs(["MU", "KL", "calcMoney"], function(values) {
            if (values.MU >= 10 && values.calcMoney == "1") {
                setAttrs({
                    MU: Math.floor(parseInt(values.MU) - 10)
                });
                setAttrs({
                    KL: Math.floor(parseInt(values.KL) + 1)
                });
            }
        });
    });

    on("change:KL", function() {
        getAttrs(["KL", "TT"], function(values) {
            if (values.KL >= 10) {
                setAttrs({
                    KL: Math.floor(parseInt(values.KL) - 10)
                });
                setAttrs({
                    TT: Math.floor(parseInt(values.TT) + 1)
                });
            }
        });
    });

    on("change:TT", function() {
        getAttrs(["TT", "GF"], function(values) {
            if (values.TT >= 10) {
                setAttrs({
                    TT: Math.floor(parseInt(values.TT) - 10)
                });
                setAttrs({
                    GF: Math.floor(parseInt(values.GF) + 1)
                });
            }
        });
    });

</script>
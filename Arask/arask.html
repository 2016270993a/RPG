<h1> Arask Character Sheet </h1>
<h3> * For Handbook 1.3 * </h3>
<text> Character Name: </text>
<input type="text" name="attr_character_name" />
<!-- Level Stuff
TODO: Style lines to make them grid-aligned.  Add box width min/max -->
<strong> Level: </strong>
<input type="number" value="1" name="attr_level"/>
Race: <input type="text" name="attr_race" value=""/>
<br>
<!-- Player Character's Gameplay Stats
TODO: Style Width -->
<strong> Health: </strong>
<input type="number" value="0" name="attr_hp"/>
<text> / </text>
<input type="number" value="10" name="attr_hp_max"/>

<strong> Mana: </strong>
<input type="number" value="0" name="attr_mp"/>
<text> / </text>
<input type="number" value="10" name="attr_mp_max"/>
<input type="checkbox" name="rad_mana" value="NonMagical"> Non-Magical
<br>
<strong> Power: </strong>
<input type="number" value="0" name="attr_pp"/>
<text> / </text>
10


<hr>
<h2>Character Stats</h2>
Move Speed: <input type="text" name="attr_speed" value="30 ft."/>
Stat Points: <input type="number" value="35" name="attr_statPoints"/>
<br>
Favor: <input type="number" name=attr_favor value="0"/>
Focus: <input type="number" name=attr_focus value="1"/> / <input type="number" name=attr_focus_max value="1"/>
<!-- Update Button, updates stats! -->

<br>
<h3> Strength </h3>
<text>Score</text> 
<input type="text" name="attr_strength" value="6" />
<button type='roll' value="/em @{character_name} is rolling Strength...
/roll 1d10 + @{strength_mod} + ?{Mana/PowerBurst/Other Mod|0} + @{strength_pref} + @{strength_additional}" name="roll_strength"></button>
<!-- Option List for Adding or subtracting 1d4 -->
<text>Other Class Modifiers:</text>
<select name="attr_strength_additional">
    <option value="0">None</option>
    <option value="-2d4">-2d4</option>
    <option value="-1d4">-1d4</option>
    <option value="-1">-1</option>
    <option value="1">+1</option>
    <option value="1d4">+1d4</option>
    <option value="2d4">+2d4</option>
</select>
<br>
<text>Stat Mod</text> 
<input type="text" name="attr_strength_mod" value="1" readonly/>
<text>Preferred Stat?</text>
<input type="checkbox" name="attr_strength_pref" value="1d4" />



<br>
<h3> Intelligence </h3>
<text>Score</text> 
<input type="text" name="attr_intelligence" value="6" />
<button type='roll' value="/em @{character_name} is rolling Intelligence...
/roll 1d10 + @{intelligence_mod} + ?{Mana/PowerBurst/Other Mod|0} + @{intelligence_pref} + @{intelligence_additional}" name="roll_intelligence"></button>
<!-- Option List for Adding or subtracting 1d4 -->
<text>Other Class Modifiers:</text>
<select name="attr_intelligence_additional">
    <option value="0">None</option>
    <option value="-2d4">-2d4</option>
    <option value="-1d4">-1d4</option>
    <option value="-1">-1</option>
    <option value="1">+1</option>
    <option value="1d4">+1d4</option>
    <option value="2d4">+2d4</option>
</select>
<br>
<text>Stat Mod</text> 
<input type="text" name="attr_intelligence_mod" value="1" readonly />
<text>Preferred Stat?</text>
<input type="checkbox" name="attr_intelligence_pref" value="1d4" />




<br>
<h3> Dexterity </h3>
<text>Score</text> 
<input type="text" name="attr_dexterity" value="6" />
<button type='roll' value="/em @{character_name} is rolling Dexterity...
/roll 1d10 + @{dexterity_mod} + ?{Mana/PowerBurst/Other Mod|0} + @{dexterity_pref} + @{dexterity_additional}" name="roll_dexterity"></button>
<!-- Option List for Adding or subtracting 1d4 -->
<text>Other Class Modifiers:</text>
<select name="attr_dexterity_additional">
    <option value="0">None</option>
    <option value="-2d4">-2d4</option>
    <option value="-1d4">-1d4</option>
    <option value="-1">-1</option>
    <option value="1">+1</option>
    <option value="1d4">+1d4</option>
    <option value="2d4">+2d4</option>
</select>
<br>
<text>Stat Mod</text> 
<input type="text" name="attr_dexterity_mod" value=0 readonly />
<text>Preferred Stat?</text>
<input type="checkbox" name="attr_dexterity_pref" value="1d4" />




<br>
<h3> Charisma </h3>
<text>Score</text> 
<input type="text" name="attr_charisma" value="6" />
<button type='roll' value="/em @{character_name} is rolling Charisma...
/roll 1d10 + @{charisma_mod} + ?{Mana/PowerBurst/Other Mod|0} + @{charisma_pref} + @{charisma_additional}" name="roll_charisma"></button>
<!-- Option List for Adding or subtracting 1d4 -->
<text>Other Class Modifiers:</text>
<select name="attr_charisma_additional">
    <option value="0">None</option>
    <option value="-2d4">-2d4</option>
    <option value="-1d4">-1d4</option>
    <option value="-1">-1</option>
    <option value="1">+1</option>
    <option value="1d4">+1d4</option>
    <option value="2d4">+2d4</option>
</select>
<br>
<text>Stat Mod</text> 
<input type="text" name="attr_charisma_mod" value=0 readonly />
<text>Preferred Stat?</text>
<input type="checkbox" name="attr_charisma_pref" value="1d4" />





<br>
<h3> Awareness </h3>
<text>Score</text> 
<input type="text" name="attr_awareness" value="6" />
<button type='roll' value="/em @{character_name} is rolling Awareness...
/roll 1d10 + @{awareness_mod} + ?{Mana/PowerBurst/Other Mod|0} + @{awareness_pref} + @{awareness_additional}" name="roll_awareness"></button>
<!-- Option List for Adding or subtracting 1d4 -->
<text>Other Class Modifiers:</text>
<select name="attr_awareness_additional">
    <option value="0">None</option>
    <option value="-2d4">-2d4</option>
    <option value="-1d4">-1d4</option>
    <option value="-1">-1</option>
    <option value="1">+1</option>
    <option value="1d4">+1d4</option>
    <option value="2d4">+2d4</option>
</select>
<br>
<text>Stat Mod</text> 
<input type="text" name="attr_awareness_mod" value=0 readonly />
<text>Preferred Stat?</text>
<input type="checkbox" name="attr_awareness_pref" value="1d4" />





<br>
<h3> Resilience </h3>
<text>Score</text> 
<input type="text" name="attr_resilience" value="6" />
<button type='roll' value="/em @{character_name} is rolling Resilience...
/roll 1d10 + @{resilience_mod} + ?{Mana/PowerBurst/Other Mod|0} + @{resilience_pref} + @{resilience_additional}" name="roll_resilience"></button>
<!-- Option List for Adding or subtracting 1d4 -->
<text>Other Class Modifiers:</text>
<select name="attr_resilience_additional">
    <option value="0">None</option>
    <option value="-2d4">-2d4</option>
    <option value="-1d4">-1d4</option>
    <option value="-1">-1</option>
    <option value="1">+1</option>
    <option value="1d4">+1d4</option>
    <option value="2d4">+2d4</option>
</select>
<br>
<text>Stat Mod</text> 
<input type="text" name="attr_resilience_mod" value=0 readonly />
<text>Preferred Stat?</text>
<input type="checkbox" name="attr_resilience_pref" value="1d4" />





<br>
<h3> Luck </h3>
<text>Score</text> 
<input type="text" name="attr_luck" value="6" />
<button type='roll' value="/em @{character_name} is rolling Luck...
/roll 1d10 + @{luck_mod} + ?{Mana/PowerBurst/Other Mod|0} + @{luck_pref} + @{luck_additional}" name="roll_luck"></button>
<!-- Option List for Adding or subtracting 1d4 -->
<text>Other Class Modifiers:</text>
<select name="attr_luck_additional">
    <option value="0">None</option>
    <option value="-2d4">-2d4</option>
    <option value="-1d4">-1d4</option>
    <option value="-1">-1</option>
    <option value="1">+1</option>
    <option value="1d4">+1d4</option>
    <option value="2d4">+2d4</option>
</select>
<br>
<text>Stat Mod</text> 
<input type="text" name="attr_luck_mod" value=0 readonly />
<text>Preferred Stat?</text>
<input type="checkbox" name="attr_luck_pref" value="1d4" />





<hr>
<h2>Skill Bonuses</h2>
<fieldset class="repeating_skills"> 
<Strong>Name:</Strong>
<input type="text" name="attr_skillname" /> 
Rank:
<input type="number" name="attr_skillRank" />
Dice Bonus: 
<input type="text" name="attr_skillDiceBonus" />
Is Master?
<input type="checkbox" name="attr_skillMaster" />
</fieldset>
<hr>
<h2>Weapons and Armour</h2>
<fieldset class="repeating_weapons"> 
<Strong>Name:</Strong>
<input type="text" name="attr_weaponName" /> 
Stat:
<select name="attr_weaponStat">
    <option selected disabled>None</option>
    <option>Strength</option>
    <option>Intelligence</option>
    <option>Dexterity</option>
    <option>Charisma</option>
    <option>Awareness</option>
    <option>Resilience</option>
    <option>Luck</option>
</select>
<!-- <input type="text" name="attr_weaponStat" /> -->
Dice Bonus: 
<input type="text" name="attr_weaponDiceBonus" value="+0"/>
<br>
<Strong>Description</Strong>
<textarea name="attr_weaponDescription" rows="10" cols="10">Enter a description for this item.</textarea>
</fieldset>
<hr>



<h2>Magical Affinities</h2>
<text>Affinity Points:</text>
<input type="number" name="attr_afpt" value="10"/>
<strong>Roll Wizard Power</strong>
<button type='roll' value="/em @{character_name} casts a magic spell!
/roll 1d10 + ?{Dice Mod|0}" name="roll_wizardPower"></button>


<br>
<strong>|| MANA CALCULATOR || </strong>
<br>
<text>Mana Spent</text>
<input type="number" name="attr_manaSpent" value="0"/>
<text>==> Dice Mod</text>
<input type="text" name="attr_manaSpentMod" value="" readonly/>
<fieldset class="repeating_affinity">
    <input type="text" value="default" style="display: none"/> 
    <strong>School:</strong>
    <select name="attr_school" class="school">
        <option style="display: none" selected disabled>None</option>
        <option disabled>-------------------------</option>
        <option disabled>A-Class</option>
        <option disabled>-------------------------</option>
        <option>Black Magic</option>
        <option>White Magic</option>
        <option>Golemancy</option>
        <option>Ethermancy</option>
        <option>Runecrafting</option>
        <option>Red Magic</option>
        <option>Blood Magic</option>
        <option disabled>-------------------------</option>
        <option disabled>B-Class</option>
        <option disabled>-------------------------</option>
        <option>Fire Magic</option>
        <option>Ice Magic</option>
        <option>Earth Magic</option>
        <option>Shadow Magic</option>
        <option>Light Magic</option>
        <option>Water Magic</option>
        <option>Nature Magic</option>
        <option>Illusion Magic</option>
        <option>Lightning Magic</option>
        <option>Charm Magic</option>
        <option>Teleportation Magic</option>
        <option>Enchanting</option>
        <option>Divination</option>
        <option>Necromancy</option>
        <option>Transmutation</option>
        <option>Null Magic</option>
        <option>Alchemy</option>
        <option>Chaomancer</option>
        <option>Ritualist</option>
        <option value="1">Custom</option>
    </select>
    <text>Type:</text>
    <select name="attr_type" class="type">
        <option selected disabled>Select A Type</option>
        <option value="No Bonus">1). Benign Affinity</option>
        <option value="+1 to Rolls">2). Lesser Affinity - </option>
        <option value="+1d4 to Rolls">3). Moderate Affinity</option>
        <option value="+1d4 to Rolls, and Skilled Reroll">4). Greater Affinity</option>
        <option value="+1d4, Skilled Reroll, Master Effect">5). Spectacular Affinity</option>
    </select>
    
    <text>Effect:</text>
    <input type="text" name="attr_effect" class="effect" readonly/>
    
    <br>
    <strong>Describe Your Affinity</strong>
    <textarea name="attr_descr" rows="1" cols="1" class="descr" ></textarea>
</fieldset>

<hr>
<h2>Possessions</h2>
Copper: <input type="number" name="attr_copper" value="0"/>
Silver: <input type="number" name="attr_silver" value="0"/>
Gold: <input type="number" name="attr_gold" value="0"/>
<br>
<strong>Inventory</strong>
<br>
<textarea name="attr_inventory" rows="10" cols="10">Describe your belongings.</textarea>
<!-- Start on other Section -->
<hr>
<h2>Character Description</h2>
<strong>Wizard Power</strong>
<br>
<textarea name="attr_wizardPower" rows="8" cols="10">Describe your wizard power.</textarea>
<br>
<strong>Power Burst</strong>
<textarea name="attr_powerBurst" rows="8" cols="10">Describe your power burst.</textarea>
<br>
Age:    <input type="text" name="attr_age" value="" />
Weight: <input type="text" name="attr_weight" value="" />
Gender: <input type="text" name="attr_gender" value="" />
<br>
Height: <input type="text" name="attr_height" value="" />
Hair:   <input type="text" name="attr_hair" value="" />
Eyes:   <input type="text" name="attr_eyes" value="" />
<br>


<strong>Racial Traits</strong>
<br>
<textarea name="attr_raceTraits" rows="8" cols="10">Describe your racial abilities.</textarea>
<br>

<strong>Notes and Backstory</strong> <br>
<textarea name="attr_backstory" rows="10" cols="10">Enter a description about your character.</textarea>
<br>

<!-- TODO: Make the power point max modifiable?
<input type="text" value="10" name="attr_ppMax"/> -->
<br>

<hr>
<br><br>
© 2019 Toxic Sasquatch Games
<br>
Arask System by Westley Hindley & Taliyah Larson

<script type="text/worker">
    // .. Update button for STAT MODS
    
    on("change:repeating_affinity", function() {
        getAttrs(["repeating_affinity_type","repeating_affinity_effect"], function(values) {
           setAttrs({
               repeating_affinity_effect: values.repeating_affinity_type
           }) 
        }); 
    });
    
    on("sheet:opened change:strength change:intelligence change:dexterity change:charisma change:luck change:resilience change:awareness change:manaSpent change:manaSpentMod", function() {
        getAttrs(["strength","intelligence","dexterity","charisma","awareness","resilience","luck","manaSpent"], function(values) {
            //Do something with values.Strength
            function getModifier(stat, type)
            {
                let statMod = 0;
                let statFlat = stat;
                if(statFlat <= 0){
                    // .. Lowest Mod Possible
                    statMod = "-1d4 -3";
                }else if(statFlat == 1 || statFlat == 2){
                    statMod = "-3";    
                }else if(statFlat == 3 || statFlat == 4){
                    statMod = "-2";    
                }else if(statFlat == 5){
                    statMod = "-1";    
                }else if(statFlat == 6 || statFlat == 7){
                    statMod = "0"; 
                }else if(statFlat == 8 || statFlat == 9){
                    statMod = "1"; 
                }else{
                    // .. Apply the function for all further values
                    // -5 implies that a 10 starts at 1d4, 15 is 2d4, etc
                    let valMod = statFlat % 5;
                    let modTier = Math.floor((statFlat-5)/5);    // .. Value to apply to dice
                    switch(valMod)
                    {   
                        case 0:
                        // Divisible by 5 (5, 10, 15), these tiers are modTier d4
                        statMod =  modTier.toString() + "d4";
                        break;
                        case 1: case 2:
                        statMod = modTier.toString() + "d4 + 1"
                        break;
                        case 3: case 4:
                        statMod = modTier.toString() + "d4 + 2"
                        break;
                    }
        
                }
                return statMod;
            }
            let strengthMod = getModifier(values.strength);
            let intelligenceMod = getModifier(values.intelligence);
            let dexterityMod = getModifier(values.dexterity);
            let awarenessMod = getModifier(values.awareness);
            let luckMod = getModifier(values.luck);
            let resilienceMod = getModifier(values.resilience);
            let charismaMod = getModifier(values.charisma);
            let manaMod = getModifier(values.manaSpent);
            
            setAttrs({
                strength_mod: strengthMod,
                intelligence_mod: intelligenceMod,
                dexterity_mod: dexterityMod,
                awareness_mod: awarenessMod,
                luck_mod: luckMod,
                resilience_mod: resilienceMod,
                charisma_mod: charismaMod,
                manaSpentMod: manaMod
          });
       });
    });

</script>

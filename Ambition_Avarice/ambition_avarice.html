<input type="radio" name="attr_tab" class="tab tab1" value="1" checked="checked"><span title="Main"></span>
<input type="radio" name="attr_tab" class="tab tab2" value="2"                  ><span title="Equipment"></span>
<input type="radio" name="attr_tab" class="tab tab3" value="3"                  ><span title="NPC"></span>

<!-- <span class="version bold">Sheet Version: 1.00</span> -->

<!--  --------------------------------------------------------------------------------- -->
<!--  --------------------------- PAGE 1 ---------------------------------------------- -->
<!--  --------------------------------------------------------------------------------- -->
<div class="tab-content tab1 pg1">

<!-- NAME SECTION -->
  <div class="name section columnflex wrap">
    <div class="rowflex nowrap">
      <label>Player: </label>
      <input name="attr_player" type="text" placeholder="Player name">
    </div>
    <div class="rowflex nowrap">
      <label>Character: </label>
      <input name="attr_character_name" type="text" placeholder="character name">
    </div>
    <div class="rowflex nowrap">
      <label>Campaign: </label>
      <input name="attr_campaign" type="text" placeholder="campaign name">
    </div>

    <div class="rowflex nowrap">
      <label class="short">Race: </label>
      <input name="attr_race" type="text" placeholder="human">
    </div>
    <div class="rowflex nowrap">
      <label class="short">Class: </label>
      <input name="attr_class" type="text" placeholder="class">
    </div>
    <div class="rowflex nowrap">
      <label class="short">Gender: </label>
      <input name="attr_gender" type="text" placeholder="gender">
    </div>
  </div>

<!-- LOGO SECTION -->
  <div class="logo section"></div>


<!-- ATTRIBUTES SECTION -->

  <div class="attrs section columnflex nowrap center">
    
    <label class="title">attributes</label>
    <!--     <div>
      <button name="roll_init" type="roll" value="&{template:default} {{name=Initiative}} {{Result=[[d20]]}} &{tracker}"><span>Initiative</span></button>
    </div> -->

    <div class="rowflex nowrap">
      <label>Strength</label>
      <input name="attr_str" type="number" value="" placeholder="10">
      <span name="attr_str_mod"></span>
      <button name="roll_str" type="roll" value="&{template:default} {{name= **Strength** (Test)}} {{Roll= [[1d20+(@{str_mod})]]}}"></button>
    </div>

    <div class="rowflex nowrap">
      <label>Dexterity</label>
      <input name="attr_dex" type="number" value="" placeholder="10">
      <span name="attr_dex_mod"></span>
      <button name="roll_dex" type="roll" value="&{template:default} {{name= **Dexterity** (Test)}} {{Roll= [[1d20+(@{dex_mod})]]}}"></button>
    </div>

    <div class="rowflex nowrap">
      <label>Constitution</label>
      <input name="attr_con" type="number" value="" placeholder="10">
      <span name="attr_con_mod"></span>
      <button name="roll_con" type="roll" value="&{template:default} {{name= **Constitution** (Test)}} {{Roll= [[1d20+(@{con_mod})]]}}"></button>
    </div>

    <div class="rowflex nowrap">
      <label>Intelligence</label>
      <input name="attr_int" type="number" value="" placeholder="10">
      <span name="attr_int_mod"></span>
      <button name="roll_int" type="roll" value="&{template:default} {{name= **Intelligence** (Test)}} {{Roll= [[1d20+(@{int_mod})]]}}"></button>
    </div>

    <div class="rowflex nowrap">
      <label>Wisdom</label>
      <input name="attr_wis" type="number" value="" placeholder="10">
      <span name="attr_wis_mod"></span>
      <button name="roll_wis" type="roll" value="&{template:default} {{name= **Wisdom** (Test)}} {{Roll= [[1d20+(@{wis_mod})]]}}"></button>
    </div>

    <div class="rowflex nowrap">
      <label>Charisma</label>
      <input name="attr_cha" type="number" value="" placeholder="10">
      <span name="attr_cha_mod"></span>
      <button name="roll_cha" type="roll" value="&{template:default} {{name= **Charisma** (Test)}} {{Roll= [[1d20+(@{cha_mod})]]}}"></button>
    </div>
    
    <div class="note rowflex nowrap">
      <div class="d20"></div>
      <span> + modifier vs DC</span>
    </div>
  </div>

<!-- HP-AC SECTION -->

  <div class="hp-ac section rowflex nowrap">

    <div class="columnflex nowrap center">
      <label class="title">Hit Points</label>

      <div class="hp rowflex nowrap center middle">
        <div>
          <input name="attr_hp" type="number" value="" placeholder="10" style="margin-right: 30px;">
        </div>
        <div>
          <input name="attr_hp_max" type="number" value="" placeholder="10">
        </div>     
      </div>

      <div class="rowflex nowrap spaced die">
        <div class="rowflex nowrap">
          <label style="width:55px;">Hit Die:</label>
          <div>
            <input name="attr_hit_die" type="text" placeholder="d10">
          </div>
        </div>
        <div class="rowflex nowrap">
          <label>Rest Die:</label>
          <div>
            <input name="attr_rest_die" type="text" placeholder="1">
          </div>
        </div>
      </div>
    </div>

    <div class="columnflex nowrap center">
      <label class="title">To Hit Bonus</label>
      <div class="to-hit columnflex center middle">
        <div>
          <input name="attr_to_hit" type="number" value="" placeholder="1" style="width:35px;">
        </div>
      </div>
    </div>

    <div class="columnflex nowrap center">
      <label class="title">Armor Class</label>
      <div class="ac columnflex center middle">
        <div>
          <input name="attr_ac" type="number" value="" placeholder="10">   
        </div>
      </div>
      <div class="infra rowflex nowrap center">
        <label>infravision</label>
        <input name="attr_infravision" type="checkbox" value="">       
      </div>
    </div>

  </div>

<!-- SAVING THROWS -->

  <div class="saving section columnflex nowrap center">
    <label class="title">Saving Throws</label>
    <div class="rowflex nowrap">
      <label>blast</label>
      <input name="attr_blast" type="number" value="" placeholder="0">
      <button name="roll_blast" type="roll" value="&{template:default} {{name=**Blast** (Saving Throw)}} {{Roll=[[d20>@{blast}]]}} "></button>
    </div>
    <div class="rowflex nowrap">
      <label>death</label>
      <input name="attr_death" type="number" value="" placeholder="0">
      <button name="roll_death" type="roll" value="&{template:default} {{name=**Death** (Saving Throw)}} {{Roll=[[d20>@{death}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label>paralysis</label>
      <input name="attr_paralysis" type="number" value="" placeholder="0">
      <button name="roll_paralysis" type="roll" value="&{template:default} {{name=**Paralysis** (Saving Throw)}} {{Roll=[[d20>@{paralysis}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label>poison</label>
      <input name="attr_poison" type="number" value="" placeholder="0">
      <button name="roll_poison" type="roll" value="&{template:default} {{name=**Poison** (Saving Throw)}} {{Roll=[[d20>@{poison}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label>reflex</label>
      <input name="attr_reflex" type="number" value="" placeholder="0">
      <button name="roll_reflex" type="roll" value="&{template:default} {{name=**Reflex** (Saving Throw)}} {{Roll=[[d20>@{reflex}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label>spells</label>
      <input name="attr_spells" type="number" value="" placeholder="0">
      <button name="roll_spells" type="roll" value="&{template:default} {{name=**Spells** (Saving Throw)}} {{Roll=[[d20>@{spells}]]}} "></button>
    </div>
    
    <div class="note rowflex nowrap">
      <div class="d20"></div>
      <span>equal or greater</span>     
    </div>

  </div>

<!-- DUNGEON THROWS -->

  <div class="dungeon section columnflex nowrap">
    <label class="title">Dungeon Throws</label>
    <div class="rowflex nowrap">
      <label class="short">climb</label>
      <input name="attr_climb" type="number" value="" placeholder="0">
      <button name="roll_climb" type="roll" value=" &{template:default} {{name=**Climb** (Dungeon Throw)}} {{Roll=[[d20>@{climb}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label class="short">force</label>
      <input name="attr_force" type="number" value="" placeholder="0">
      <button name="roll_force" type="roll" value=" &{template:default} {{name=**Force** (Dungeon Throw)}} {{Roll=[[d20>@{force}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label class="short">locks</label>
      <input name="attr_locks" type="number" value="" placeholder="0">
      <button name="roll_locks" type="roll" value=" &{template:default} {{name=**Locks** (Dungeon Throw)}} {{Roll=[[d20>@{locks}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label class="short">notice</label>
      <input name="attr_notice" type="number" value="" placeholder="0">
      <button name="roll_notice" type="roll" value=" &{template:default} {{name=**Notice** (Dungeon Throw)}} {{Roll=[[d20>(@{notice})]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label class="short">sneak</label>
      <input name="attr_sneak" type="number" value="" placeholder="0">
      <button name="roll_sneak" type="roll" value=" &{template:default} {{name=**Sneak** (Dungeon Throw)}} {{Roll=[[d20>@{sneak}]]}} "></button>
    </div>

    <div class="rowflex nowrap">
      <label class="short">traps</label>
      <input name="attr_traps" type="number" value="" placeholder="0">
      <button name="roll_traps" type="roll" value=" &{template:default} {{name=**Traps** (Dungeon Throw)}} {{Roll=[[d20>@{traps}]]}} "></button>
    </div>
  </div>

<!-- IN SIX -->
  <div class="sixes section columnflex nowrap center">
    <label class="title">In Sixes Chances</label>
    <textarea name="attr_in_sixes" placeholder="In Sixes Chances"></textarea>
    <div class="note rowflex nowrap">
      <div class="d6"></div>
      <span>equal or lower</span>
    </div>
    
  </div>

<!-- PROFICIENCIES -->

  <div class="profs section columnflex nowrap center">
    <label class="title">proficiencies</label>
    <textarea name="attr_proficiencies" placeholder="proficiencies"></textarea>
  </div>

<!-- KNOWN SPELLS -->

  <div class="k-spells section columnflex nowrap center">
    <label class="title">Spells Known</label>
    <textarea name="attr_known_spells" placeholder="Magic Missile"></textarea>
  </div>

<!-- CLASS FEATURES -->

  <div class="class section columnflex nowrap center">
    <label class="title">Class Features</label>
    <div class="rowflex nowrap">
      <label>Expertise:</label>
      <input name="attr_expertise" type="text" placeholder="expertise">
    </div>
    <div class="rowflex nowrap">
      <label>Identify:</label>
      <input name="attr_identify" type="text" placeholder="identify">
    </div>
    <div class="rowflex nowrap">
      <label>Other:</label>
      <input name="attr_other" type="text" placeholder="other">
    </div>
  </div>

<!-- languages -->

  <div class="lang section columnflex nowrap center">
    <label class="title">Languages</label>
    <textarea name="attr_languages" placeholder="Common"></textarea>
  </div>

<!-- spells per day -->

  <div class="spells-d section columnflex nowrap center">
    <label class="title">Spells per Day</label>
    <div class="rowflex nowrap">
      <div class="columnflex nowrap">
        <label>1st</label>
        <input name="attr_lvl1_spells" type="number" value="" class="ref" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label>2nd</label>
        <input name="attr_lvl2_spells" type="number" value="" class="ref" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label>3rd</label>
        <input name="attr_lvl3_spells" type="number" value="" class="ref" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label>4th</label>
        <input name="attr_lvl4_spells" type="number" value="" class="ref" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label>5th</label>
        <input name="attr_lvl5_spells" type="number" value="" class="ref" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label>6th</label>
        <input name="attr_lvl6_spells" type="number" value="" class="ref" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label>7th</label>
        <input name="attr_lvl7_spells" type="number" value="" class="ref" placeholder="0">
      </div>      
    </div>
  </div>

<!-- encumberance -->

  <div class="speed section columnflex nowrap center">
    <label class="title">Encumberance & Speed</label>
    <div class="rowflex nowrap center">
      <div class="columnflex nowrap">
        <label class="short">status</label>
        <input name="attr_status" type="number" value="" class="ref" placeholder="status">
      </div>
      <div class="columnflex nowrap">
        <label class="short">weight</label>
        <input name="attr_weight" type="number" value="" class="ref" placeholder="weight">
      </div>
      <div class="columnflex nowrap">
        <label style="margin-right:10px;">exploration</label>
        <input name="attr_exploration" type="number" value="" class="ref" placeholder="30" style="margin-left: 15px;">
      </div>
      <div class="columnflex nowrap">
        <label class="short">combat</label>
        <input name="attr_combat" type="number" value="" class="ref" placeholder="30">
      </div>
      <div class="columnflex nowrap">
        <label class="short">sprint</label>
        <input name="attr_sprint" type="number" value="" class="ref" placeholder="30">
      </div>
    </div>

  </div>

<!-- memorized spells -->

  <div class="spells-m section columnflex nowrap center">
    <label class="title">Memorized Spells</label>
    <textarea name="attr_spells_memo" placeholder="Magic Missile, Mage Armor etc."></textarea>
  </div>

<!-- misc -->

  <div class="misc section columnflex nowrap center">
    <label class="title">Miscellany</label>
    <textarea name="attr_misc" placeholder="Misc. notes"></textarea>
  </div>

<!-- EXP -->

  <div class="exp section columnflex nowrap center">
    <label class="title">Experience Points</label>
    <div class="rowflex nowrap">
      <label>current</label>
      <input name="attr_xp" type="number" value="" placeholder="0">
    </div>
    <div class="rowflex nowrap">
      <label>next level</label>
      <input name="attr_xp_next" type="number" value="" placeholder="100">
    </div>
    <div class="rowflex nowrap">
      <label>character level</label>
      <input name="attr_level" type="number" value="1">
    </div>
  </div>

</div>

<!--  --------------------------------------------------------------------------------- -->
<!--  --------------------------- PAGE 2 ---------------------------------------------- -->
<!--  --------------------------------------------------------------------------------- -->

<div class="tab-content tab2 pg2">

<!-- coin -->

  <div class="coin section columnflex nowrap center">
    <label class="title">Coin</label>
    <div class="rowflex nowrap">
      <div class="columnflex nowrap">
        <label class="small">CP</label>
        <input name="attr_cp" type="number" value="" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label class="small">SP</label>
        <input name="attr_sp" type="number" value="" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label class="small">EP</label>
        <input name="attr_ep" type="number" value="" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label class="small">GP</label>
        <input name="attr_gp" type="number" value="" placeholder="0">
      </div>
      <div class="columnflex nowrap">
        <label class="small">PP</label>
        <input name="attr_pp" type="number" value="" placeholder="0">
      </div>      
    </div>

  </div>

<!-- equipment -->

  <div class="equip section columnflex nowrap">
    <label class="title">Equipment</label>
    <fieldset class="repeating_eq">
      <div class="rowflex nowrap">
        <input name="attr_name" type="text" placeholder="name" style="width:30%;margin-right: 5px;">
        <input name="attr_info" type="text" placeholder="info" style="width: 67%;">
      </div>

    </fieldset>
  </div>


<!-- companions -->

  <div class="companions section columnflex nowrap">
    <label class="title">Companions</label>
    <fieldset class="repeating_companions">
      <div class="rowflex wrap">
        <input name="attr_name" type="text" placeholder="name" style="width: 60%;">
        <input name="attr_type" type="text" placeholder="type" style="width: 36%;margin-left: 10px;">
        <input name="attr_abilities" type="text" placeholder="abilities" style="width:100%;">        
      </div>
    </fieldset>
  </div>


</div>


<!--  --------------------------------------------------------------------------------- -->
<!--  --------------------------- PAGE 3 ---------------------------------------------- -->
<!--  --------------------------------------------------------------------------------- -->


<div class="tab-content tab3 pg3">
  
  <!-- NPC main block -->
  <div class="npc-main section columnflex nowrap center">
    <label>Name:</label>
    <input name="attr_character_name" type="text">
  </div>

  <!-- NOTES -->
  <div class="notes section columnflex nowrap center">
    <label class="title">Notes</label>
    <textarea name="attr_notes"></textarea>
  </div>

</div>


<!--  --------------------------------------------------------------------------------- -->
<!--  --------------------------- Sheet workers --------------------------------------- -->
<!--  --------------------------------------------------------------------------------- -->

<input name="attr_str_mod" type="hidden" value="0">
<input name="attr_dex_mod" type="hidden" value="0">
<input name="attr_con_mod" type="hidden" value="0">
<input name="attr_wis_mod" type="hidden" value="0">
<input name="attr_int_mod" type="hidden" value="0">
<input name="attr_cha_mod" type="hidden" value="0">

<script type="text/worker">

const int = score => parseInt(score, 10) || 0;


const stats = ["str", "dex", "con", "wis", "int", "cha"];
stats.forEach(stat => {
    on(`change:${stat}`, () => {
        getAttrs([stat], values => {
            const stat_base = int(values[stat]);
            //console.log(stat_base);
            let stat_mod = 0;
            if (stat_base >= 19) stat_mod = "+4";
            else if (stat_base >= 18) stat_mod = "+3";
            else if (stat_base >= 16) stat_mod = "+2";
            else if (stat_base >= 14) stat_mod = "+1";
            else if (stat_base >= 12) stat_mod = "+0";
            else if (stat_base >= 8) stat_mod = "-1";
            else if (stat_base >= 6) stat_mod = "-2";
            else stat_mod = "-3";
            
            setAttrs({
                [`${stat}_mod`]: stat_mod
            });
        });
    });
});

</script>